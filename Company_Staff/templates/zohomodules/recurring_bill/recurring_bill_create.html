{% extends 'base.html' %}
{% load static %}
{% block content %}




<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.4.js" integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E="
crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!--dropdown button-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://kit.fontawesome.com/274ee977b7.js" crossorigin="anonymous"></script>

<style>
    label{
        color: white;
    }
    .section-3
    {
        display: flex;
        justify-content: flex-start;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1.5rem;
        margin-top: 1rem;
    }
    .section-3 .section-toggle
    {
        margin-bottom: 0.50rem;
    }
     .section-toggle a
    {

        color: rgb(230, 171, 45);
        font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
        font-size:1.275rem;
    }
    .add_another
    {
       
        color: rgb(230, 171, 45);
    }
    #tbl thead th{
        font-size: 0.785rem;
    }
    @media (max-width:700px)
    {
    .section-3
    {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr 1fr ;  

    }
    .section-3 .section-toggle a
    {

        color: rgb(230, 171, 45);
        font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
        font-size:0.875rem;
    }
    }
   
       
</style>


<style>
    .modal{
      z-index: 9999;
      overflow: scroll;
    }
    /* width */
    ::-webkit-scrollbar {
        width: 10px;
    }

    /* Track */
    ::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    /* Handle */
    ::-webkit-scrollbar-thumb {
        background: #888;
    }

    /* Handle on hover */
    ::-webkit-scrollbar-thumb:hover {
        background: #555;
    }

    .hide {
        display: none;
    }
    .hidden {
      display: none;
  }
  .selectize-input.full {
    background-color:rgb(45, 44, 44) !important;
    color: white !important;
    border: 1px solid rgba(246, 241, 241, 0.35) !important;
   }
   
    .popup-0 {
      height: 17rem;
      width: 20rem;
      background-color: rgb(3, 3, 3);
      border-radius: 1rem;
      position: absolute;
      margin-bottom:70rem;
      left: 0%;
      transform: translate(-50%, -50%)scale(0.1);
      text-align: center;
      padding: 0 5rem 5 rem;
      color: black;
      
      visibility: hidden;
      transform: translate(-50%, -50%)scale(0.1);

    }

    .open-popup-3 {
      margin-top: -30rem;
      visibility: visible;
      transform: translate(-50%, -50%)scale(1);
      transition: transform 0.4s, top 0.4s;
      margin-left: 40rem;
    background-color: #000;
    }
    ::placeholder {
      color: rgb(238, 230, 230); /* Change this to the desired color */
    }
    label {
      color:white; /* Change this to the desired color */
    }
    input[type="text"],
input[type="number"],
input[type="email"],
input[type="date"] {
  color: white; /* Change this to the desired color */
}
</style>

<section >
    <div >
     
      <div class="col-md-12 " style="width: 100%;">
        
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

<div class="body-wrapper">
  <div class="container-fluid">
      <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'company_dashboard' %}" class="text-warning-emphasis">Dashboard</a></li>
            <li class="breadcrumb-item"><a href="{% url 'recurring_bill_listout' %}" class="text-warning-emphasis">Reccuring Bills</a></li>
            <li class="breadcrumb-item" aria-current="page">New</li>
          </ol>
      </nav>

      <div class="row mt-3">
          <div class="container">
              
          </div>
      </div>
      <form action="{% url 'add_new_recrring_bill' %}" method="post" enctype="multipart/form-data" class="rounded p-3" style="background-color: black;">
        {% csrf_token %}
        <div class="page-content">
          <div class=" radius-15">
            <div >
              <div >
                <h3 class="mb-0 text-light"> CREATE NEW RECURRING BILL</h3>
              </div>
              <hr />
            </div>
          </div>
          <div class=" radius-15">
            <div>
    <div id="invoice">
        <div class="row">
                <div class="row">
                    <div class="col-xl-3">
                        <label class="text-white">Vendor Name</label><span class="text-danger ml-3" id="vendor"></span>
                    </div>
                    <div class="col-xl-7">
                        <div class="d-flex">
                            <div id="custom_dropdowns" class="position-relative">
                                <div class="position-absolute text-light  border border-dark" style="margin-top: 3rem;width: 18rem;background-color: black;border: 1px solid gray;">
                                    <div id="custom-dropdowns">
                                        <div style="overflow-y: auto;max-height: 10rem;" name="account" id="add_vendor_data">
                                        {% if vendors %}
                                            {% for i in vendors %}
                                                    <p class="account_drop_hovers ps-3 px-2 py-1 m-0" onclick="get_vendors_details(this)">{{ i.first_name }}</p>
                                                    <span hidden>{{ i.id }}</span>
                                            {% endfor %}
                                        {% else %}
                                            <h6 class="account_drop_hovers ps-3 p-2 m-0 text-light" style="cursor: not-allowed;pointer-events: none;">No Vendors are available</h6>
                                        {% endif %}
              
                                        </div>
                                    </div>
                                </div>
                              </div>
                              <input hidden id="account_value" type="text" name="vendor_id" value="">
                              <input type="text" class="form-control text-light" id="account_list" name="vendor_name" placeholder="search..." required>
                              <script>
                                document.getElementById('custom_dropdowns').style.display = 'none'
                                $('#account_list').on('click',function(){
                                  $('#custom_dropdowns').toggle()
                                  // $('#customer_list').val('')
                                })
                                $('#custom_dropdowns').on('click',function(){
                                  $('#custom_dropdowns').toggle()
                                  $('#custom_dropdowns p').each(function(){
                                    $(this).show()
                                  })
                                })
                                $('.account_drop_hovers').on('click',function(){
                                  $('#account_list').val($(this).text())
                                  $('#account_value').val($(this).next('span').text())
                                })
                                $(document).ready(function(){
                                  $('#account_value').val('')
                                })
                                $('#account_list').on('keyup',function(){
                                  var textInput = $(this).val().toLowerCase()
                                  $('#custom_dropdowns p').each(function(){
                                    if(($(this).text().toLowerCase().indexOf(textInput)) >-1 )
                                    {
                                      $(this).show()
                                    }
                                    else{
                                      $(this).hide()
                                    }
                                  })
                                })</script>
                                <button type="button" data-toggle="modal" data-target="#newVendor" class="btn btn-outline-warning ms-1">+</button>
                        </div>
                    </div>
                </div>

            <div class="row mt-3">
                <div class="col-xl-3">
                    <label class="text-white">GST Treatment</label>
                </div>
                <div class="col-xl-7">

                <input type="text" class="form-control" id="gstType" name="gst_type" placeholder="GST Treatment"  readonly>
                </div>
            </div>
            
            <div class="row mt-3">
                <div class="col-xl-3">
                    <label class=" text-white">Email</label>
                </div>
                <div class="col-xl-7">
                    <input class="form-control" type="email" name="vendorEmail" placeholder="Email"  id="vendorEmail" readonly>
                </div>
            </div>

            <div class="row mt-3" id="gstInDisplay">
                <div class="col-xl-3">
                    <label class=" text-white">GSTIN</label>
                </div>
                <div class="col-xl-7">
                    <input type="text" class="form-control" id="gstin" name="gstin" placeholder="GSTIN"  readonly>
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-xl-3">
                    <label class=" text-white">Billing Address</label>
                </div>
                <div class="col-xl-7">
                    <textarea class="form-control" name="bill_address" id="billAddress" rows="4" style=" color: white;" readonly></textarea>
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-xl-3">
                    <label class="text-white">Source of supply</label>
                </div>
                <div class="col-xl-7">
                    <select type="text" class="form-control  text-white"  style=" background-color:rgb(0, 0, 0);" id="vendor_source_of_suppy" name="vendor_source_of_suppy" required >
                        <option value="" selected disabled>--Choose--</option>
                        <option value="[AN]-Andaman and Nicobar Islads">[AN] Andaman and Nicobar Islads</option>
                        <option value="[AD]-Andhra Predhesh">[AD] Andhra Predhesh</option>
                        <option value="[AR]-Arunachal Predesh">[AR] Arunachal Predesh</option>
                        <option value="[AS]-Assam">[AS] Assam</option>
                        <option value="[BR]-Bihar">[BR] Bihar</option>
                        <option value="[CH]-Chandigarh">[CH] Chandigarh</option>
                        <option value="[CG]-Chhattisgarh">[CG] Chhattisgarh</option>
                        <option value="[DNH]-Dadra and Nagar Haveli">[DNH] Dadra and Nagar Haveli</option>
                        <option value="[DD]-Damn anad Diu">[DD] Damn anad Diu</option>
                        <option value="[DL]-Delhi">[DL] Delhi</option>
                        <option value="[GA]-Goa">[GA] Goa</option>
                        <option value="[GJ]-Gujarat">[GJ] Gujarat</option>
                        <option value="[HR]-Haryana">[HR] Haryana</option>
                        <option value="[HP]-Himachal Predesh">[HP] Himachal Predesh</option>
                        <option value="[JK]-Jammu and Kashmir">[JK] Jammu and Kashmir</option>
                        <option value="[JH]-Jharkhand">[JH] Jharkhand</option>
                        <option value="[KA]-Karnataka">[KA] Karnataka</option>
                        <option value="[KL]-Kerala">[KL] Kerala</option>
                        <option value="[LA]-Ladakh">[LA] Ladakh</option>
                        <option value="[LD]-Lakshadweep">[LD] Lakshadweep</option>
                        <option value="[MP]-Madhya Predesh">[MP] Madhya Predesh</option>
                        <option value="[MH]-Maharashtra">[MH] Maharashtra</option>
                        <option value="[MN]-Manipur">[MN] Manipur</option>
                        <option value="[ML]-Meghalaya">[ML] Meghalaya</option>
                        <option value="[MZ]-Mizoram">[MZ] Mizoram</option>
                        <option value="[NL]-Nagaland">[NL] Nagaland</option>
                        <option value="[OD]-Odisha">[OD] Odisha</option>
                        <option value="[PY]-Puducherry">[PY] Puducherry</option>
                        <option value="[PB]-Punjab">[PB] Punjab</option>
                        <option value="[RJ]-Rajasthan">[RJ] Rajasthan</option>
                        <option value="[SK]-Sikkim">[SK] Sikkim</option>
                        <option value="[TN]-Tamil Nadu">[TN] Tamil Nadu</option>
                        <option value="[TS]-Telangana">[TS] Telangana</option>
                        <option value="[TR]-Tripura">[TR] Tripura</option>
                        <option value="[UP]-Uttar Predesh">[UP] Uttar Predesh</option>
                        <option value="[UK]-Uttarakhand">[UK] Uttarakhand</option>
                        <option value="[WB]-West Bengal">[WB] West Bengal</option>
                        <option value="[OT]-Other Territory">[OT] Other Territory</option>
                      </select>
                </div>
            </div>
            
        </div>

        <div class="row">
            <div class="row mt-3">
                <div class="col-xl-3">
                    <label class=" text-white">Recurring Bill No.</label><span class="text-danger ml-3" id="invNoErr"></span>
                </div>
                <div class="col-xl-7">
                    <input type="text" class="form-control text-light" name="bill_number"  id="bill_number"  placeholder="{{ recc_bill_no.recc_rec_number }}" required>
                    <small id="invalid_recurr_no_indicator" hidden class="text-center text-danger ps-2">Recurring Bill no is not continues !</small>
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-xl-3">
                    <label class="">Reference Number</label>
                </div>
                <div class="col-xl-7">
                    <input type="text" class="form-control text-light" name="reference_number" value="{% if recc_bill_no %}{{ recc_bill_no.ref_number }}{% else %}01{% endif %}"  readonly>
                </div>
            </div>
        </div>

        <hr class="mt-4">

        <div class="row">

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class="">Profile Name</label>
                    </div>
                    <div class="col-xl-8">
                        <input type="text" class="form-control text-light" name="profile_name" value=""  >
                    </div>
                </div>
            </div>

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class="text-white" for="orderNum">Purchase Order Number: </label> 
                    </div>
                    <div class="col-xl-8">
                        <input class="form-control" type="text" name="order_number" id="orderNum">
                    </div>
                </div>
            </div>

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class=" text-white">Repeat Every:</label>
                    </div>
                    <div class="col-xl-8">
                        <div class="d-flex">
                            <select class="form-control text-white my-select" style=" background-color:rgb(0, 0, 0);" id="repeat_every_recurr" name="repeat_every_recurr" required>
                                <option  class="text-white"value="" selected disabled>Select Repeat Every</option>
                                <option  class="text-white"value="3 month">3 month</option>
                                <option  class="text-white"value="6 month">6 month</option>
                                <option  class="text-white"value="1 year">1 year</option>
                                {% for i in repeat_list %}
                                <option class="text-white" value="{{ i.id }}" text="{{ i.repeat_duration }} {{ i.repeat_type }}">{{ i.repeat_duration }} {{ i.repeat_type }}</option>
                                {% endfor %}
                            </select>
                            <a class="btn btn-outline-warning ms-1" role="button" data-target="#newRepeatEntry" data-toggle="modal" id="termsadd">+</a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class=" text-white">Reccuring Bill Date:</label>
                    </div>
                    <div class="col-xl-8">
                        <input type="date" class="form-control" style="background-color: rgb(30, 30, 30);" name="rec_bil_Date" id="rec_bil_Date"  value="{% now 'Y-m-d' %}">
                    </div>
                </div>
            </div>

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class=" text-white">Expiry Date:</label>
                    </div>
                    <div class="col-xl-8">
                        <input type="text" id="dueDate" class="form-control" name="due_date" readonly>
                    </div>
                </div>
            </div>

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class=" text-white">Credit Period:</label>
                    </div>
                    <div class="col-xl-8">
                        <div class="d-flex">
                            <select class="form-control text-white"  style=" background-color:rgb(0, 0, 0);" name="credit_period"  id="credit_period" required>
                                <option value="" selected disabled> Select Credit Period</option>
                                <option value="0">Due on Reciept</option>
                                <option value="30">NET 30</option>
                                <option value="60">NET 60</option>
                                {% for i in credits %}
                                    <option class="text-white" value="{{i.days}}" text="{{i.id}}">{{i.credit_name}}</option>
                                {% endfor %}
                            </select>
                            <a class="btn btn-outline-warning ms-1" role="button" data-target="#newPaymentTerm" data-toggle="modal" id="termsadd">+</a>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="row">


            <div class="col-md-3 mt-3">
                
                
            </div>
        </div>
        <hr class="mt-4">   

        <!-- add custom here -->
        <div class="row">

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class="text-white">Customer Name</label><span class="text-danger ml-3" id="vendor"></span>
                    </div>
                    <div class="col-xl-8">
                        <div class="d-flex">
                            <div id="custom_dropdowns1" class="position-relative">
                              <div class="position-absolute text-light  border border-dark" style="margin-top: 3rem;width: 18rem;background-color: black;border: 1px solid gray;">
                                  <div id="custom-dropdowns">
                                      <div style="overflow-y: auto;max-height: 10rem;" name="account" id="customer_add">
                                      {% if customers %}
                                          {% for i in customers %}
                                              <p class="account_drop_hovers1 ps-3 p-2 m-0" onclick="get_customer_details(this)">{{ i.first_name }}</p>
                                              <span hidden>{{ i.id }}</span>
                                          {% endfor %}
                                      {% else %}
                                          <h6 class="account_drop_hovers1 ps-3 p-2 m-0 text-light" style="cursor: not-allowed;pointer-events: none;">No Customers are available</h6>
                                      {% endif %}
            
                                      </div>
                                  </div>
                              </div>
                            </div>
                            <input hidden id="account_value1" type="text" name="account_id" value="">
                            <input type="text" class="form-control text-light" id="account_list1" name="customer_name" placeholder="search..." required>
                            <script>
                              document.getElementById('custom_dropdowns1').style.display = 'none'
                              $('#account_list1').on('click',function(){
                                $('#custom_dropdowns1').toggle()
                                // $('#customer_list').val('')
                              })
                              $('#custom_dropdowns1').on('click',function(){
                                $('#custom_dropdowns1').toggle()
                                $('#custom_dropdowns1 p').each(function(){
                                  $(this).show()
                                })
                              })
                              $('.account_drop_hovers1').on('click',function(){
                                $('#account_list1').val($(this).text())
                                $('#account_value1').val($(this).next('span').text())
                              })
                              $(document).ready(function(){
                                $('#account_value1').val('')
                              })
                              $('#account_list1').on('keyup',function(){
                                var textInput = $(this).val().toLowerCase()
                                $('#custom_dropdowns1 p').each(function(){
                                  if(($(this).text().toLowerCase().indexOf(textInput)) >-1 )
                                  {
                                    $(this).show()
                                  }
                                  else{
                                    $(this).hide()
                                  }
                                })
                              })</script>
                              <button type="button" data-toggle="modal" data-target="#newCustomer" class="btn btn-outline-warning ms-1">+</button>
                          </div>
                    </div>
                </div>
            </div>

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class="text-white">GST Type</label>
                    </div>
                    <div class="col-xl-8">
                        <input type="text" class="form-control" id="cust_gstType" name="cust_gst_type" placeholder="GST Treatment"  readonly>
                    </div>
                </div>
            </div>

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class=" text-white">Email</label>
                    </div>
                    <div class="col-xl-8">
                        <input class="form-control" type="email" name="customerEmail" placeholder="Email"  id="cust_Email" readonly>
                    </div>
                </div>
            </div>

            <div class="col-xl-6" id="cust_gstInDisplay" style="display: block;">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class=" text-white">GSTIN</label>
                    </div>
                    <div class="col-xl-8">
                        <input type="text" class="form-control" id="cust_gstin" name="cust_gstin" placeholder="GSTIN"  readonly>
                    </div>
                </div>
            </div>

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class=" text-white">Billing Address</label>
                    </div>
                    <div class="col-xl-8">
                        <textarea class="form-control" name="cust_bill_address" id="cust_bill_Address" rows="4" style=" color: white;" readonly></textarea>
                    </div>
                </div>
            </div>

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class="text-white">Place of supply</label>
                    </div>
                    <div class="col-xl-8">
                        <select type="text" class="form-control  text-white"  style="background-color:black" id="place_of_supply" name="place_of_supply" required>
                            <option value="" selected disabled>--Choose--</option>
                            <option  value="[AN]-Andaman and Nicobar Islads">[AN] Andaman and Nicobar Islads</option>
                            <option value="[AD]-Andhra Predhesh">[AD] Andhra Predhesh</option>
                            <option value="[AR]-Arunachal Predesh">[AR] Arunachal Predesh</option>
                            <option value="[AS]-Assam">[AS] Assam</option>
                            <option value="[BR]-Bihar">[BR] Bihar</option>
                            <option value="[CH]-Chandigarh">[CH] Chandigarh</option>
                            <option value="[CG]-Chhattisgarh">[CG] Chhattisgarh</option>
                            <option value="[DNH]-Dadra and Nagar Haveli">[DNH] Dadra and Nagar Haveli</option>
                            <option value="[DD]-Damn anad Diu">[DD] Damn anad Diu</option>
                            <option value="[DL]-Delhi">[DL] Delhi</option>
                            <option value="[GA]-Goa">[GA] Goa</option>
                            <option value="[GJ]-Gujarat">[GJ] Gujarat</option>
                            <option value="[HR]-Haryana">[HR] Haryana</option>
                            <option value="[HP]-Himachal Predesh">[HP] Himachal Predesh</option>
                            <option value="[JK]-Jammu and Kashmir">[JK] Jammu and Kashmir</option>
                            <option value="[JH]-Jharkhand">[JH] Jharkhand</option>
                            <option value="[KA]-Karnataka">[KA] Karnataka</option>
                            <option value="[KL]-Kerala">[KL] Kerala</option>
                            <option value="[LA]-Ladakh">[LA] Ladakh</option>
                            <option value="[LD]-Lakshadweep">[LD] Lakshadweep</option>
                            <option value="[MP]-Madhya Predesh">[MP] Madhya Predesh</option>
                            <option value="[MH]-Maharashtra">[MH] Maharashtra</option>
                            <option value="[MN]-Manipur">[MN] Manipur</option>
                            <option value="[ML]-Meghalaya">[ML] Meghalaya</option>
                            <option value="[MZ]-Mizoram">[MZ] Mizoram</option>
                            <option value="[NL]-Nagaland">[NL] Nagaland</option>
                            <option value="[OD]-Odisha">[OD] Odisha</option>
                            <option value="[PY]-Puducherry">[PY] Puducherry</option>
                            <option value="[PB]-Punjab">[PB] Punjab</option>
                            <option value="[RJ]-Rajasthan">[RJ] Rajasthan</option>
                            <option value="[SK]-Sikkim">[SK] Sikkim</option>
                            <option value="[TN]-Tamil Nadu">[TN] Tamil Nadu</option>
                            <option value="[TS]-Telangana">[TS] Telangana</option>
                            <option value="[TR]-Tripura">[TR] Tripura</option>
                            <option value="[UP]-Uttar Predesh">[UP] Uttar Predesh</option>
                            <option value="[UK]-Uttarakhand">[UK] Uttarakhand</option>
                            <option value="[WB]-West Bengal">[WB] West Bengal</option>
                            <option value="[OT]-Other Territory">[OT] Other Territory</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="col-xl-6">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class=" text-white">Payment Type</label>
                    </div>
                    <div class="col-xl-8">
                        <select class="form-control text-white my-select" style=" background-color:rgb(0, 0, 0);" id="paymentMethod" name="payment_method" >
                            <option  class="text-white"value="" selected disabled>Select Payment Method</option>
                            <option  class="text-white"value="Cash">Cash</option>
                            <option  class="text-white"value="Cheque">Cheque</option>
                            <option  class="text-white"value="UPI">UPI</option>
                            {% for b in banks %}
                            <option class="text-white" value="{{ b.bnk_name }}" text="{{ b.id }}">{{ b.bnk_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>

            <div class="col-xl-6" style="display:none;"  id="chequediv">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class="" >Cheque No</label>
                    </div>
                    <div class="col-xl-8">
                        <input type="text" class="form-control text-white" name="cheque_id" id="cheque_id" placeholder="Enter Cheque No" >
                    </div>
                </div>
            </div>

            <div class="col-xl-6" style="display:none;" id="upidiv">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class="" >UPI ID</label>
                    </div>
                    <div class="col-xl-8">
                        <input type="text" class="form-control text-white" name="upi_id" id="upi_id" placeholder="Enter UPI ID" >
                    </div>
                </div>
            </div>

            <div class="col-xl-6" style="display:none;" id="bnkdiv">
                <div class="row mt-3">
                    <div class="col-xl-4">
                        <label class="" >Account </label>
                    </div>
                    <div class="col-xl-8">
                        <input type="text" class="form-control text-white" name="bnk_id" id="bnk_id"  readonly >
                    </div>
                </div>
            </div>

        </div>

        <hr class="mt-4">
        <div class="row">

            <div class="col-xl-6">
                <div class="row">
                    <div class="col-xl-4">
                        <div class="d-flex mt-2">
                            <input type="checkbox" class="form-check text-white me-3" name="cheque_id" id="price_enable" placeholder="Enter Cheque No" >
                            <label class="" >Price List:</label>
                        </div>
                    </div>
                    <div class="col-xl-8">
                        <select class="form-control mt-2" name="name_latest1" id="price_display" >
                            <option value="0" selected disabled>select price list</option>
                            {% for i in pricelist %}
                            <option value="{{ i.id }}">{{ i.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                
                
            </div>
        </div>
        <hr class="mt-4">
        <div class="row" id="applyPriceListSection" style="display: none;">
            <div class="col-md-3 mt-3">
                <div class="form-group form-check">
                    <input type="checkbox" class="form-check-input" name="priceList" id="applyPriceList" value="applyPriceList">
                    <input type="hidden" name="priceListId" value="" id="customerPriceListId">
                    <label class="form-check-label" for="applyPriceList">Apply Price List</label>
                    <br>
                    <span class="text-success" id="custPriceListName" style="display: none;"></span>
                </div>
            </div>
        </div>

    <!-- <form method="post" action="" enctype="multipart/form-data" class=""> -->
        {% csrf_token %}
        <input class="hidden"  id="state1" name="hidden_state1" value="{{ details.company.state  }}">
                <input class="hidden"  id="state" name="hidden_state" value="">

                <input class="hidden" type="text" name="samp" id="samp" >
                <input class="hidden"  id="cus_place" name="hidden_cus_place"  value="">
    


<div class="row  ">
  <div class="col-md-12 table-responsive-md mt-3">
      <table class="table table-bordered  mt-3" id="recurr_item_tabel">
          <thead>
              <tr>
                  <th class="text-center text-warning">#</th>
                  <th class="text-center text-warning">PRODUCT / SERVICE</th>
                  <th class="text-center text-warning">HSN</th>
                  <th class="text-center text-warning">QTY</th>
                  <th class="text-center text-warning">PRICE</th>
                  <th class="text-center text-warning">TAX (%)</th>
                  <th class="text-center text-warning">DISCOUNT</th>
                  <th class="text-center text-warning">TOTAL</th>
                  <th class="text-center text-warning">remove</th>

              </tr>
          </thead>
          <tbody id="items-table-body">
              <tr id='tab_row1'>
                  <td class="nnum" style="text-align: center;color: white; ">1</td>
                  <td style="width: 20%;">
                      <div class="d-flex">
                          <div class="w-100">
                              <div class="p-0 border-0 bg-none text-light position-relative drop-box" style="display: block;">
                                  <input required type="text" id="item1" value="" name="item_name[]" class="dropdown-toggle form-control item-display" onkeyup="filterFunction($(this).attr('id'))"  data-toggle="dropdown" aria-expanded="false" placeholder="Items.." autocomplete="off">
                                  <ul class="dropdown-menu w-100 items-available position-absolute" id="menu1"  style="overflow-y: auto; height: fit-content;max-height: 40vh;color: white; background-color:rgb(45, 44, 44);"> 
                                    {% for i in items %}
                                      <li class="dropdown items-options text-light ps-2" onclick="getItemDetails($(this).parent().prev().attr('id'),`{{i.item_name}}`)">{{i.item_name}}</li>
                                      {% endfor %}
                                  </ul>
                                  
                              </div>
                          </div>
                          
                          <a href="#">
                              <button type="button" class="btn btn-outline-warning ml-1" data-target="#newitem" data-toggle="modal">+</button>
                          </a>
                      </div>
                  
                  </td>
                  <td style="width: 8rem;">
                      <input type="hidden" name="item_id[]" id="itemId1">
                      <input type="text" name='hsn[]' id="hsn1" placeholder='HSN Code' class="form-control HSNCODE"  style="text-align: center;color: white; " readonly />
                  </td>
                  <td >
                      <input type="number" name='qty[]' id="qty1"   style="text-align: center;color: white; " class="form-control qty mb-1" step=0 min=1  value=0 onchange="changeItemQty(this.id)" required/>
                      <input type="text" id="avl1" style="display: none;">
                      <div class="d-flex"  style="text-align: center;color: white; "><span>Avail Qty: </span><span id="qtyspan1" class=''></span></div>
                  </td>
                  <td>
                      <input type="number" name='price[]' id="price1" class="form-control price"   style="text-align: center;color: white; "step="0.00" min="0" style=" display: block;" value=0 readonly />
                      <input type="number" name='priceListPrice[]' id="priceListPrice1" class="form-control priceListPrice" step="0.00" min="0" style="display: none;" value=0 readonly />
                  </td>
                  
                  <td style="width: 13%;">
                      <!-- <input type="text"  id="select_tax" placeholder="Tax Rate" class="form-control seltax d-flex"> -->
                        <select name='taxGST[]' id="taxGST1"   class="form-control tax_ref tax_ref_gst" style="display: block; text-align: center;color: white; background-color:rgb(45, 44, 44);" onchange="taxchange(this.id)">
                            <option selected disabled hidden>Select GST</option>
                            <option value=28 >28.0% GST</option>
                            <option value=18 >18.0% GST</option>
                            <option value=12 >12.0% GST</option>
                            <option value=5 >05.0% GST</option>
                            <option value=3 >03.0% GST</option>
                            <option value=0 >0.0% GST</option>
                        </select>
                        <select name='taxIGST[]' id="taxIGST1"   class="form-control tax_ref tax_ref_igst" style="display: none; text-align: center;color: white;background-color:rgb(45, 44, 44);" onchange="taxchange(this.id)">
                            <option selected disabled hidden >Select IGST</option>
                            <option value=28 >28.0% IGST</option>
                            <option value=18 >18.0% IGST</option>
                            <option value=12 >12.0% IGST</option>
                            <option value=5 >05.0% IGST</option>
                            <option value=3 >03.0% IGST</option>
                            <option value=0 >0.0% IGST</option>
                        </select>
                      <div class="mt-1" style=" text-align: center;color: red;" ><span id="invalidtax1" style="display: none;"> Invalid Tax %</span> </div>    
                  </td>
                  <td >
                      <input type="number"  style="text-align: center;color: white; " name='discount[]'  placeholder='Enter Discount' id="disc1" value=0 class="form-control disc" step=0 min=0   />
                  </td>

                  <td><input type="number"  style="text-align: center;color: white; " name='total[]' id="total1" class="form-control total" value=0 readonly  /></td>
                  <td style="display: none;"><input type="hidden" id="taxamount1" class="form-control itemTaxAmount" /></td>
                  <td>
                      <button type="button" id="1" class="btn btn-warning font-weight-bold clone_row fa fa-clone px-2 my-1 py-1" title="Clone Row" ></button><br>
                      <button type="button" id="1" class="btn btn-danger remove_row px-2 py-1 mx-1 fa fa-close" title="Remove Row"> </button>
                  </td>
              </tr>
          </tbody>
          <tr>
              <td style="border: none;"><a class="btn btn-outline-warning ml-1" role="button" id="add" >+</a></td>
          </tr>
      </table>
  </div>
</div>
<div class="row clearfix" style="margin-top:20px">
  <div class="col-md-6">
      <textarea class="form-control mt-3"  id="" name="note" placeholder="Note" style="height: 190px;"></textarea>
      <label for="file-upload" class="btn text-white border-0"
      style="background-color: rgb(210, 132, 30);">
      <i class="fas fa-upload text-white"></i> Upload File
  </label>
  <input class="pb-3"  id="file-upload" type="file" name="file" style="display:none;">
</div>            
  <div class="col-md-1"></div>
  <div class="col-md-5 table-responsive-md mt-3 " id="recurr_item_tabelTotal" style="background-color:rgba(0,0,0,.4); border: 1px solid rgba(128, 128, 128, 0.6); margin-left: -2vh;">
      <div class="p-3">
          <div class="row container-fluid p-2 m-0">
              <div class="col-sm-4 mt-2"><label class="text-center">Sub Total</label></div>
              <div class="col-sm-1 mt-2">:</div>
              <div class="col-sm-7 mt-2"><input type="number" step="any" name='subtotal' value=0.00 readonly  class="form-control" id="sub_total"></div>
          </div>
          <div class="row container-fluid p-2 m-0" id="taxamountIGST" style="display: flex;">
              <div class="col-sm-4 mt-2"><label for="a" class="text-center">IGST</label></div>
              <div class="col-sm-1 mt-2">:</div>
              <div class="col-sm-7 mt-2"><input type="number" name='igst' step="any" id="igstAmount1" value=0.00 readonly  class="form-control"/></div>
          </div>
          <div class="row container-fluid p-2 m-0" style="display: none;" id="taxamountCGST">
              <div class="col-sm-4 mt-2"><label for="a" class="text-center">CGST</label></div>
              <div class="col-sm-1 mt-2">:</div>
              <div class="col-sm-7 mt-2"><input type="number" name='cgst' step="any" id="cgstAmount1" value=0.00 readonly  class="form-control"/></div>
          </div>
          <div class="row container-fluid p-2 m-0" style="display: none;" id="taxamountSGST">
              <div class="col-sm-4 mt-2"><label for="a" class="text-center">SGST</label></div>
              <div class="col-sm-1 mt-2">:</div>
              <div class="col-sm-7 mt-2"><input type="number" name='sgst' step="any" id="sgstAmount1" value=0.00 readonly class="form-control"/></div>
          </div>
          <div class="row container-fluid p-2 m-0">
              <div class="col-sm-4 mt-2"><label for="a" class="text-center">Tax Amount</label></div>
              <div class="col-sm-1 mt-2">:</div>
              <div class="col-sm-7 mt-2"><input type="number" step="any" name='taxamount' id="tax_amount" value=0.00 readonly  class="form-control"/></div>
          </div>
          
          <div class="row container-fluid p-2 m-0" >
              <div class="col-sm-4 mt-2"><label for="a" class="text-center">Shipping Charge</label></div>
              <div class="col-sm-1 mt-2">:</div>
              <div class="col-sm-7 mt-2"><input type="number" step="any" name='ship' id="ship" value=0.00 class="form-control"/></div>
          </div>
          <div class="row container-fluid p-2 m-0">
              <div class="col-sm-4 mt-2"><label for="a" class="text-center">Adjustment</label></div>
              <div class="col-sm-1 mt-2">:</div>
              <div class="col-sm-7 mt-2"><input type="number" step="any" name='adj' id="adj" value=0.00 class="form-control"/></div>
          </div>
          <div class="row container-fluid p-2 m-0">
              <div class="col-sm-4 mt-2"><label for="a" class="text-center text-warning">Total</label></div>
              <div class="col-sm-1 mt-2">:</div>
              <div class="col-sm-7 mt-2"><input type="number" name='grandtotal' id="grandtotal" value=0.00 readonly  class="form-control"/></div>
          </div>
      </div>
  </div>
</div>
<div class="row">
  <div class="col-md-7"></div>
  <div class="col-md-5 table-responsive-md mt-3 " id="recurr_item_tabelPaid" style="background-color:rgba(0,0,0,.4); border: 1px solid rgba(128, 128, 128, 0.6); margin-left: -2vh;">
      <div class="p-3">
          <div class="row container-fluid p-2 m-0">
              <div class="col-sm-4 mt-2"><label for="a" class="text-center text-warning">Paid </label></div>
              <div class="col-sm-1 mt-2">:</div>
              <div class="col-sm-7 mt-2"><input type="number" step="any" name='advance' id="advance"  value=0.00 class="form-control"/></div>
          </div>
          <div class="row container-fluid p-2 m-0">
              <div class="col-sm-4 mt-2"><label for="a" class="text-center text-warning">Balance</label></div>
              <div class="col-sm-1 mt-2">:</div>
              <div class="col-sm-7 mt-2"><input type="number" name='balance' id="balance" value=0.00 readonly  class="form-control text-warning" readonly /></div>
          </div>
      </div>
  </div>
</div>
</div>

<div class="row">
    <div class="col-md-7 mt-3">
        <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="agreeTerms" required style="background-color: #a97c00;">
            <label for="agreeTerms">Agree to terms and conditions</label>
            <div class="invalid-feedback">You must agree before submitting.</div>
        </div>
    </div>
    <div class="col-md-5 mt-3 d-flex">
        <button type="submit" name="Draft" class="btn  text-white " 
  value="Draft" style="background-color:  rgb(199, 88, 37) ;">Save as Draft</button>
<button type="submit" name="Save" class="btn  text-white" 
  value="Save" style="background-color: rgb(210, 132, 30);">Save and Send</button>
<input class="btn  text-white"
  type="reset" value="Cancel" style="background-color:  rgb(59, 59, 58) ;">
    </div>
</div>


</div>
</div>
</div>

</form>

</div>




<!-- New Repeat Every Modal -->

<div class="modal fade" id="newRepeatEntry">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="background-color: rgb(32, 35, 37);">
            <div class="modal-header">
                <h5 class="m-3 text-white">New Repeat Every</h5>
                <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class=" p-3">
                    <form method="post" id="new_repeat_every" style="background-color: black;" class="p-2 rounded">
                        {% csrf_token %}
                        <div class="row mt-2">
                            <div class="col-12">
                                <label for="name">Duration:</label>
                                <input type="text" name="term_name" id="repeat_duration" class="form-control text-white w-100">
                            </div>
                            <div class="col-12">
                                <label for="name">Type</label>
                                <select name="title" id="repeat_type" style="background-color: black;color: white;" class="form-control">
                                    <option value="Week">Week</option>
                                    <option value="Month">Month</option>
                                    <option value="Year">Year</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="col-4"></div>
                            <div class="col-4 d-flex justify-content-center">
                                <button class="btn btn-outline-warning text-grey w-75" data-dismiss="modal" type="submit" id="save_repeat_every">Save</button>
                            </div>
                            <div class="col-4"></div>
                        </div>
                    </form>
                </div>
            </div>
        </div>   
    </div>
</div>

<!-- end -->


<!-- New Credit Period Modal -->

<div class="modal fade" id="newPaymentTerm">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="background-color: rgb(32, 35, 37);">
            <div class="modal-header">
                <h5 class="m-3 text-white">New Credit Period</h5>
                <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class=" p-3">
                    <form method="post" id="newTermForm" style="background-color: black;" class="p-2 rounded">
                        {% csrf_token %}
                        <div class="row mt-2">
                            <div class="col-12">
                                <label for="name">Term Name</label>
                                <input type="text" name="term_name" id="termName" class="form-control text-white w-100">
                            </div>
                            <div class="col-12">
                                <label for="name">Days</label>
                                <input type="number" name="days" id="termDays" class="form-control text-white w-100" min="0" step="1">
                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="col-4"></div>
                            <div class="col-4 d-flex justify-content-center">
                                <button class="btn btn-outline-warning text-grey w-75" data-dismiss="modal" type="submit" id="saveCreditPeriod">Save</button>
                            </div>
                            <div class="col-4"></div>
                        </div>
                    </form>
                </div>
            </div>
        </div>   
    </div>
</div>

<!-- New Cust Payment Term Modal -->

<div class="modal fade" id="newCustomerPaymentTerm">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="background-color: #0f1820;">
            <div class="modal-header">
                <h5 class="m-3 text-white">New Vendor Payment Term</h5>
                <button type="button" class="close" data-toggle="modal" data-target="#newVendor" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class=" p-3">
                    <form method="post" id="newCustomerPaymentTermForm">
                        {% csrf_token %}
                        <div class="row mt-2">
                            <div class="col-6">
                                <label for="name">Term Name</label>
                                <input type="text" name="term_name" id="custTermName" class="form-control text-white w-100">
                            </div>
                            <div class="col-6">
                                <label for="name">Days</label>
                                <input type="number" name="days" id="custTermDays" class="form-control text-white w-100" min="0" step="1">
                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="col-4"></div>
                            <div class="col-4 d-flex justify-content-center">
                                <button class="btn btn-outline-warning text-grey w-75" data-toggle="modal" data-target="#newVendor" type="button" id="saveCustomerPaymentTerm">Save</button>
                            </div>
                            <div class="col-4"></div>
                        </div>
                    </form>
                </div>
            </div>
        </div>   
    </div>
</div>


<!-- New Customer Modal -->

<div class="modal fade" id="newCustomer">
    <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background-color: #0f1419;">
            <div class="modal-header">
                <h5 class="m-3 text-white">New Customer</h5>
                <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class=" p-3">
                    <form action="{% url 'recurr_customer_create' %}"  method="post" id="newCustomerForm" style="background-color: black;" class="rounded p-2">
                        {% csrf_token %}
                        <div class="form-group row mt-4">
                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color: white;">Customer Type</label>
                            
                            <div class=" col-sm-12 col-md-3 col-lg-3">
                                <input  type="radio"  value="Business" name="type" >
                                        <label for="Business"> Business</label>
                                       &nbsp;&nbsp;&nbsp;
                                       <input  type="radio"  value="Individual" name="type" >
                                       <label for="Business">Individual</label>
                            </div><br></div>
        
        
        
                        <div class=" form-group row">
                            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                                <label>Primary Contact</label>
                            </div>
                            <div class="col-sm-12 col-md-1 col-lg-1" >
                                <select id="select1"  name="salutation" class="form-control bg-light text-dark mt-2 " >
                                
                                    <option value="Mr">Mr</option>
                                    <option value="Mrs">Mrs</option>
                                    <option value="Ms">Ms</option>
                                    <option value="Dr">Dr</option>
        
                                </select> 
                            </div>
                            <div class="col-sm-12 col-md-2 col-lg-3" >
                                <input  type="text" class="form-control bg-light text-dark mt-2 change-disply " id="fname" name="first_name" placeholder="first name" required >
        
                            </div>
                            <div class="col-sm-12 col-md-2 col-lg-3" >
                                <input type="text" class="form-control bg-light text-dark mt-2 " id="lname" name="last_name" placeholder="last name" required >
        
                            </div>
                        </div>
        
                        <div class="form-group row mt-4">
                            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Customer Display Name</label></div>
                            <div class="col-sm-12 col-md-6 col-lg-7">
                               
                                <select class="form-control bg-light text-dark "  name="v_display_name" id="v_display_name">
                                    
                                </select>
                                
                                   
                                    
                            </div>
                        </div>
        
        
                        <div class="form-group row mt-4">
                            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                                <label>Company Name</label>
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-7">
                                <input  type="text" class="form-control bg-light text-dark " name="company_name" required>     
                                <div class="invalid-feedback">Please fill out this field.</div>   
        
                            </div>
                        </div>
        
                       
        
                       
        
                        <div class="form-group row mt-4">
                            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Customer Email</label></div>
                            <div class="col-sm-12 col-md-6 col-lg-7">
                                <input  type="email" class="form-control bg-light text-dark" name="vendor_email"  id="vendor-email"  required> 
                                <span class=" text-danger mt-1" id="email-message-id" style="font-size: 10px;"></span>   
            
                            </div>
        
        
                        </div>
        
                        <div class="form-group row mt-4">
                            <div class="col-sm-12 col-md-3 col-lg-3 ">
                                <label class="col-form-label text-white">Customer phone</label>
                            </div>
                            <div class="col-sm-12 col-md-3 col-lg-3">
                                <input id="workphone"  type="text" class="form-control bg-light text-dark mt-2" pattern="[0-9]{7}"  name="w_phone" placeholder="work phone" required>
                                <span id="work-phone-message" class="mt-2 " style="font-size: 10px;"></span >
                                <span id="workphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span >
                                <div class="invalid-feedback"></div>   
            
                            </div>
                            <div class=" col-sm-12 col-md-3 col-lg-4">
                                <input id="mphone"  type="text" pattern="[0-9]{10}" class="form-control bg-light text-dark mt-2"  name="m_phone" placeholder="mobile number" required>
                                <span id="phone-message" class="mt-2 " style="font-size: 10px;"></span >
                                <span id="mphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span >
                                <div class="invalid-feedback"></div>   
            
                            </div>
        
                            <hr style="border: none; height: 2px; background-color: #ffcc00; margin: 20px 0;">
        
                            <div class="toggle1 section-toggle">
                                <a href="">Add More Details</a>
        
                            </div>
        
        
                        </div>
                        
        
                        <fieldset1 id="more_detail" class="more details" style="display: none;">
        
                            <div class="form-group row mt-4">
                                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                                    <label>Skype name/Number</label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <input  type="text" class="form-control bg-light text-dark" name="skype_number">      
                                </div>
        
                            </div>
        
                            <div class="form-group row mt-4">
                                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                                    <label>Designation</label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <input  type="text" class="form-control bg-light text-dark" name="designation">      
                                </div>
        
                            </div>
        
                            <div class="form-group row mt-4">
                                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                                    <label>Department</label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <input  type="text" class="form-control bg-light text-dark" name="department">      
                                </div>
        
                            </div>
        
        
                   
                        <div class="form-group row mt-4">
                            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Website</label></div>
                            <div class="col-sm-12 col-md-6 col-lg-6">
                                <input id="web" type="text" class="form-control bg-light text-dark" onclick="mobile_phone()"    name="website">      
                            </div>
                        </div>
                    </fieldset1>
        
        
                        <hr style="border: none; height: 2px; background-color: #ffcc00; margin: 20px 0;">
        
                        <div class="section-3">
        
                            <div class="toggle2 section-toggle"> <a href="" >Other Details </a> </div>
                            <div class="toggle3 section-toggle" > <a href="">Address </a> </div>
                            <div class="toggle4 section-toggle"><a href="" >Contact Persons </a></div>
                            <div class="toggle7 section-toggle"><a href="">Remarks</a></div>
        
                        </div>
        
                       
                        <fieldset2 class="other details">
        
                            <div class="form-group row mt-2">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > GST Treatment*</label>
                                
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <select name="gst" id="GSTT" class="form-control bg-light text-dark" onclick="gstPan_function()">
                                        <option value="Select a Gst Treatment" selected>Select a Gst Treatment</option>
                                        <option value="Registered Business-Regular Business that is registered under GST">Registered Business-Regular Business that is registered under GST</option>
                                        <option value="Registered Business-Composition Business that is registered under the Composition scheme in GST">
                                            Registered Business-Composition Business that is registered under the Composition schemen in GST
                                        </option>
                                        <option value="Unregistered Business-not Registered under GST">Unregistered Business-not Registered under GST</option>
                                        <option value="Overseas- Persons with who you do import or exports of supplies outside india">Overseas- Persons with who you do import or exports of supplies outside india</option>
                                        <option value="Special Economic Zone">Special Economic Zone</option>
                                    </select><br>
                                </div>
        
        
                            </div>
        
                            <fieldset3 id="gst" style="display: none;">
                                <div class="row mt-4">
                                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white"  > GSTIN/UIN*</label>
                                    
                                    <div class=" col-sm-12 col-md-3 col-lg-3">
                                        <input type="text" class="form-control bg-light text-dark" name="gst_number" id="gstInput" > 
                                        <span id="gstMessage"></span>       
                
                                    </div>
                
                
                                </div>
        
                            </fieldset3>
        
                            <fieldset4 id="pan" style="display: none;">
                                <div class=" row mt-4">
                                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > PAN</label>
                                    
                                    <div class=" col-sm-12 col-md-3 col-lg-3">
                                        <input type="text" class="form-control bg-light text-dark"  id="panInput"  name="pan_number">  
                                        <span id="panMessage"></span>    
        
                
                                    </div>
                
                
                                </div>
        
                            </fieldset4>
        
        
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Source of Supply*</label>
                                
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <select name="source_supply" id="PLACE" class="form-control bg-light text-dark">
                                        <option value="value" selected></option>
                                        <option value="[AN]-Andaman And Nicobar Islands">[AN]-Andaman And Nicobar Islands</option>
                                        <option value="[AD]-Andhra Pradesh">[AD]-Andhra Pradesh</option>
                                        <option value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh	</option> 
                                        <option value="volvo">[AS]-Assam</option>
                                        <option value="[BR]-Bihar">[BR]-Bihar</option> 
                                        <option value="volvo">[CH]-	Chandhigarh</option>
                                        <option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
                                        <option value="[DD]-Daman Diu">[DD]-Daman Diu</option>
                                        <option value="volvo">[DL]-	Delhi</option>
                                        <option value="[GA]-Goa">[GA]-Goa</option> 
                                        <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
                                        <option value="[HR]-Haryana">[HR]-Haryana</option> 
                                        <option value="[HP]-Himachal Pradesh">[HP]-Himachal Pradesh</option>
                                        <option value="[JK]-Jammu And Kashmir">[JK]-Jammu And Kashmir</option>
                                        <option value="[JH]-Jharkand">[JH]-Jharkand</option>
                                        <option value="[KA]-Karnataka">[KA]-Karnataka</option>
                                        <option value="[KL]-Kerala">[KL]-Kerala</option>
                                        <option value="[LA]-Ladakh">[LA]-Ladakh</option>
                                        <option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
                                        <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option>
                                        <option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
                                        <option value="[MN]-Manipur">[MN]-Manipur</option>  
                                        <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
                                        <option value="[MZ]-Mizoram">[MZ]-Mizoram</option>
                                        <option value="[NL]-Nagaland">[NL]-Nagaland</option> 
                                        <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                                        <option value="[OD]-Odisha">[OD]-Odisha</option>
                                        <option value="[PY]-Puducherry">[PY]-Puducherry</option>
                                        <option value="[PB]-Punjab">[PB]-Punjab.</option>
                                        <option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
                                        <option value="[SK]-Sikkim">[SK]-Sikkim</option>
                                        <option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
                                        <option value="[TS]-Telenghana">[TS]-Telenghana</option>
                                        <option value="[TR]-Tripura">[TR]-Tripura</option>
                                        <option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
                                        <option value="[UK]-Utharakhand">[UK]-Utharakhand</option>
                                        <option value="[WB]-West Bengal">[WB]-West Bengal</option>
                                        <option value="[OT]-Other Territory">[OT]-Other Territory</option>
                                    </select>
                                </div>
            
            
                            </div>
        
        
        
                            <!-- <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:rgb(214, 75, 75) ;">Tax Preference*</label>
                                
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <input type="checkbox" id="Taxable" name="tax1" value="Taxable">&nbsp;
                                    <label for="vehicle1" class="pt-1">Taxable</label>
                                    &nbsp;&nbsp;&nbsp;
                                    <input type="checkbox" id="Tax_Exempt" name="tax1" value="Tax Exempt">&nbsp;
                                    <label for="vehicle2" class="pt-1">Tax Exempt</label>
                              
                                </div>
                            </div> -->
        
        
        
        
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:rgb(214, 75, 75) ;">Tax Preference*</label>
                                
                            <div class="col-sm-12 col-md-3 col-lg-4 d-flex align-items-center">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="tax1" id="Taxable" value="Taxable" required>
                                    <label class="form-check-label text-white" for="vehicle1">Taxable</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="tax1" id="Tax_Exempt" value="Tax Exempt" required>
                                    <label class="form-check-label text-white" for="vehicle2">Tax Exempt</label>
                                </div>
                            </div>
                        </div>
        
             
                            <!-- </div> -->
                            
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Currency*</label>
                                
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <select name="currency" id="PLACE" class="form-control bg-light text-dark">
                                        <option value="Indian Rupee" selected>Indian Rupee</option>
                                        <!-- <option value="Indian Rupee">Indian Rupee</option> -->
                            
                                    </select>
                                </div>
            
            
                            </div>
        
                            <div class="form-group row mt-2">
                                <div class="col-sm-12 col-md-3 col-lg-3 ">
                                   <label class="col-form-label text-white mb-3"> Opening Balance Type</label>
                                </div>
                                <div class="col-sm-12 col-md-3 col-lg-4 d-flex align-items-center">
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="op_type" id="debit" value="debit">
                                        <label class="form-check-label text-white" for="debit">Debit</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="op_type" id="credit" value="credit">
                                        <label class="form-check-label text-white" for="credit">Credit</label>
                                    </div>
                                </div>
                            </div>
        
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Opening Balance Amount</label>                    
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <input  type="number" class="form-control bg-light text-dark" name="opening_bal" id="opa" value="0.00">      
                                </div>
                            </div>
        
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" >Credit Limit</label>                    
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <input  type="number" class="form-control bg-light text-dark" name="credit_lm" id="cl" value="0.00">      
                                </div>
                            </div>
                        
                          <!-- Alert -->
                            <div id="custom-alert" class="alert">
                                <span class="close-btn">&times;</span>
                                <div class="alert-content">
                                  Credit limit should not exceed opening balance amount.
                                </div>
                              </div>
                              <style>
                                .alert {
                                        display: none;
                                        position: fixed;
                                        top: 30%;
                                        left: 50%;
                                        transform: translate(-50%, -50%);
                                        background-color: #f44336;
                                        color: white;
                                        padding: 15px;
                                        border-radius: 5px;
                                        }
        
                                        .close-btn {
                                        float: right;
                                        cursor: pointer;
                                        }
        
                                        .alert-content {
                                        margin-bottom: 10px;
                                        }
                              </style>
        
        
        
        
                            
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Payment Terms</label>
                                
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <select name="payment_terms" id="paytearm-select" class="form-control bg-light text-dark">
                                       
        
                                        {% for pay_terms in payments %}
                                        <option value="{{pay_terms.id}}" >{{pay_terms.term_name}}</option>
                                    {% endfor %}
                                        
                                    </select>
        
                                </div>
            
                                <div class="col-md-4 ">
                                    <a href="#" class="btn btn-outline-secondary py-2 my-1" data-target="#newpayment" data-toggle="modal" style="color: white; background-color: rgb(210, 132, 30);" >+</a>
                                </div>
                            
        
        
        
            
                            </div>
        
                
        
        
        
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white">Price List </label>
                                 
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <select name="plst" id="PLACE" id="PLACE" class="form-control bg-light text-dark">
                                        <option value="0">Not selected</option>
        
                                        
                                        {% for price_list in pricelist %}
        
                                        <option value="{{price_list.id}}">{{price_list.name}}</option>
            
                                            
                                        {% endfor %}
        
                                         
                                         
                                          
                                         </select>
                                   
                                </div>
                    
                    
                            </div>
                         
                                 
            
                                  
            
            
            
            
            
            
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:white ;">
                                                Portal Language</label>
                                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                                    <select name="plang" id="PLACE" style="width: 100%;" class="form-control bg-light text-dark">
                                                        <option selected value="0" >Choose..</option>
                                                        <option value="ENGLISH">ENGLISH</option>
                                                      </select>
                                            </div></div>   
                                            <div class="form-group row mt-4">
                                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:white ;">Facebook </label>
                                                    <div class=" col-sm-12 col-md-3 col-lg-3"> 
                                                        <input type="text" id="cn" name="fbk" class="form-control bg-light text-dark" >
                                                        
                                                </div></div>
                                            <div class="form-group row mt-4">
                                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:white ;">Twitter</label>
                                                    <div class=" col-sm-12 col-md-3 col-lg-3">
                                                        <input type="text" id="cn" name="twtr" class="form-control bg-light text-dark" >
                                                      
                                                </div></div>
                                                
        
        
        
        
                        </fieldset2>
        
        
                        <!------------------ Address Section Start------------- -->
        
                        <fieldset5 id="address" style="display: none;">
                            <div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-6 col-lg-6">
                                        <div class="row">
                                            <div class="col-sm-12 col-md-6 col-lg-6">
                                                <label for="">BILLING ADDRESS</label>
                                            </div>
                                            <div class="col"></div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Attention</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="text" class="form-control bg-light text-dark" name="battention" id="batten">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Country</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <select name="bcountry" id="btry" class="form-control bg-light text-dark">
                                                    <option value="India" selected>India</option>
                                                </select>      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Address</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <textarea class="form-control bg-light " style="border: none;color: rgb(7, 7, 7);" cols="26" rows="4" name="baddress" id="badd1"></textarea>
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > City</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="text" class="form-control bg-light text-dark" name="bcity" id="bcty">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > State</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input type="text" class="form-control bg-light text-dark" name="bstate" id="bste">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Zip Code </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="number" class="form-control bg-light text-dark" name="bzip" id="bzp">      
                                            </div>
                                        </div>
                                    
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Phone </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input id="bphone_num"  type="tel" pattern="[0-9]{10}" class="form-control bg-light text-dark" name="bphone" >
                                                <label for="" id="bphone_label"></label>      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Fax </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" onmouseout="fax_number()"  onclick="bphone_number()"                                       name="bfax" id="bfx">  
                                            
                                                <label for="" id="fax_label"></label> 
                                            </div>
                                        </div>
        
                                    </div>
                                    <div class="col-sm-12 col-md-6 col-lg-6">
                                        <div class="row">
                                            <div class="col-sm-12 col-md-6 col-lg-6">
                                                <label for="">SHIPPING ADDRESS</label>
                                            </div>
                                            <div class="col-sm-12 col-md-6 col-lg-6">
                                                <input  type="checkbox" id="myCheckT" onclick="myCopyAddressFunction()">&nbsp;
                                                <label for="myCheck">Same as Billing Address:</label>
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Attention</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="text" class="form-control bg-light text-dark " style="color: white;" name="sattention" id="satten">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Country</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <select name="s_country" id="sctry" class="form-control bg-light text-dark">
                                                    <option value="India" selected>India</option>
                                                </select>      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Address</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <textarea class="form-control bg-light" style="border: none;color: rgb(10, 10, 10);" id="sadd1" cols="26" rows="4" name="saddress"></textarea>
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > City</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="text" class="form-control bg-light text-dark" name="scity" id="scty">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > State</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input type="text" class="form-control bg-light text-dark" name="sstate" id="sste">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Zip Code </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="number" class="form-control bg-light text-dark" name="szip" id="szp">      
                                            </div>
                                        </div>
                                    
        
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Phone </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{10}" style="color: white;" name="sphone" id="sphone_num">  
                                                <label for="" id="sphone_label"></label>    
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Fax </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" style="color: white;" name="sfax" onclick="sphone_number()" onmouseout="sfax_number()" id="sfx"> 
                                                <label for="" id="sfax_label"></label>     
                                            </div>
                                        </div>
        
                                    </div>
                                </div>
                            </div>
                        </fieldset5>
        
                        <!---------------------Address  Section End -------------->
        
        
                        <!------------------ Contact Person Section Start------------- -->
        
                        <fieldset6 id="contact_person" style="display: none;" >
                            <div class="row">
                                <div class="col-sm-12 ">
                                    
                                    <div class="table-responsive">
                                    
                                        <table id="tbl" class="table text-white" style="background-color: rgba(250, 227, 198, 0.5);">
                                            <thead>
                                                <tr>
                                                    
                                                <th>Salutation</th>
                                                <th>First Name</th>
                                                <th>Last Name</th>
                                                <th>Email Address</th>
                                                <th >Work Phone <br><span id="twph_label"></span></th>
                                                <th >Mobile <br><span id="tlabel"></span>    </th>
                                                <th >Skype Name/No</th>
                                                <th >Designation</th>
                                                <th >Department</th>
                                                <th>Action</th>
        
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                            <td><select name="salutation[]" class="form-control bg-transparent border-1 text-white"  id="PLACE" >
                                                <option class="text-dark"  >Select</option>
                                                <option class="text-dark" value="Mr" >Mr.</option>
                                                <option class="text-dark" value="Mrs">Mrs.</option>
                                                <option class="text-dark" value="Ms">Ms.</option>
                                                <option class="text-dark" value="Miss">Miss.</option>
                                                <option class="text-dark" value="Dr">Dr.</option>
                                                </select></td>
                                            <td><input type="text" class=" form-control border-1 bg-transparent text-white"    name="first_name[]"  ></td>
                                            <td><input type="text"class="form-control border-1 bg-transparent text-white"  name="last_name[]" /></td>
                                            <td>
                                                <input type="text" class="form-control border-1 bg-transparent text-white" name="email[]" />
                                                
                                                
                                            </td>
                                            
                                            <td>
                                                <input type="tel" pattern="[0-9]{7}" class="form-control border-1 bg-transparent text-white"  id="twphone" name="wphone[]"/>
                                               
                                            </td>
                                            <td>
                                                <input type="tel" pattern="[0-9]{10}"  class="form-control border-1 bg-transparent text-white"  id="tmobile" onclick="sample1()"   name="mobile[]" />
                                                
                                            </td>
                                            <td><input type="number" class="form-control border-1 bg-transparent text-white"  onclick="sample()" name="skype[]" /></td>
                                            <td><input type="text" class="form-control border-1 bg-transparent text-white"  name="designation[]" /></td>
                                            <td><input type="text" class="form-control border-1 bg-transparent text-white"  name="department[]" /></td>
                                            <td><button type="button" class="btn btn-danger" onclick="deleteContact(this)">Delete</button></td>
                                            </tr>
                                        </tbody>
                                        </table>
                                        
                                    </div>
                                    
                                    <div class="button add_another mt-3 ">
                                        <i class="fa fa-user-plus" aria-hidden="true"></i> 
                                        <span class="text-small" style="margin-left: 0.30rem;">
                                            Add Contact Person
                                        </span>
                                    </div>
                                       
                                    
                                </div>
                                
                            </div>
        
                        </fieldset6>
        
                        <!---------------------Contact Person Section End -------------->
        
        
                        <!------------------ Remark Section Start------------- -->
        
                        <fieldset7 class="remarks" style="display: none;">
                            <div class="row">
                                <div class="col-sm-12 col-md-8 col-lg-8">
                                    <div class="form-group row mt-4">
                                        <div class=" col-sm-12 col-md-6 col-lg-6">
                                            <textarea class="bg-light w-100" style="border: none;color: rgb(5, 5, 5);"   rows="5" name="remark"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-12 col-md-2 col-lg-2"></div>
                            </div>
        
                        </fieldset7>
        
                        <!---------------------Remark Section End -------------->
                        
                        <div class="row mt-5">
                            <div class="col-sm-12 col-md-2 col-lg-2 mt-3">
                                <button type="submit" class="btn btn-outline-warning form-control bg-warning text-dark" style="font-weight: bold;">Save</button>
                               
                            </div>
                            
                            <div class=" col-sm-12 col-md-2 col-lg-2 mt-3">
                                <button type="reset" class="form-control  bg-warning text-dark" style="font-weight: bold;">Cancel</button>
                               
                            </div> 
        
        
                        </div>
                    </form>
                </div>
            </div>
        </div>   
    </div>
</div>

<!-- New Vendor Modal -->

<div class="modal fade" id="newVendor">
    <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
            <div class="modal-header">
                <h5 class="m-3 text-white">New Vendor</h5>
                <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="rounded p-2" style="background-color: black;">
                    <form  method="post" action="{% url 'recurr_vendor_create' %}"  enctype="multipart/form-data" class="mb-3">
                        {% csrf_token %}
                
                        <div class=" form-group row">
                            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                                <label>Primary Contact</label>
                            </div>
                            <div class="col-sm-12 col-md-1 col-lg-1" >
                                <select id="select1"  name="salutation" class="form-control bg-light text-dark mt-2 " >
                                
                                    <option value="Mr">Mr</option>
                                    <option value="Mrs">Mrs</option>
                                    <option value="Ms">Ms</option>
                                    <option value="Dr">Dr</option>
        
                                </select> 
                            </div>
                            <div class="col-sm-12 col-md-2 col-lg-3" >
                                <input  type="text" class="form-control bg-light text-dark mt-2 change-disply " id="fname" name="first_name" placeholder="first name" required >
        
                            </div>
                            <div class="col-sm-12 col-md-2 col-lg-3" >
                                <input type="text" class="form-control bg-light text-dark mt-2 " id="lname" name="last_name" placeholder="last name" required >
        
                            </div>
                        </div>
        
                        <div class="form-group row mt-4">
                            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                                <label>Company Name</label>
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-7">
                                <input  type="text" class="form-control bg-light text-dark " name="company_name" required>     
                                <div class="invalid-feedback">Please fill out this field.</div>   
        
                            </div>
                        </div>
        
                       
        
                        <div class="form-group row mt-4">
                            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Vendor Display Name</label></div>
                            <div class="col-sm-12 col-md-6 col-lg-7">
                               
                                <select class="form-control bg-light text-dark "  name="v_display_name" id="v_display_name">
                                    
                                </select>
                                
                                   
                                    
                            </div>
                        </div>
        
                        <div class="form-group row mt-4">
                            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Vendor Email</label></div>
                            <div class="col-sm-12 col-md-6 col-lg-7">
                                <input  type="email" class="form-control bg-light text-dark" name="vendor_email"  id="vendor-email"  required> 
                                <span class=" text-danger mt-1" id="email-message-id" style="font-size: 10px;"></span>   
            
                            </div>
        
        
                        </div>
        
                        <div class="form-group row mt-4">
                            <div class="col-sm-12 col-md-3 col-lg-3 ">
                                <label class="col-form-label text-white">  Vendor phone</label>
                            </div>
                            <div class="col-sm-12 col-md-3 col-lg-3">
                                <input id="workphone"  type="text" class="form-control bg-light text-dark mt-2" pattern="[0-9]{7}"  name="w_phone" placeholder="work phone" required>
                                <span id="work-phone-message" class="mt-2 " style="font-size: 10px;"></span >
                                <span id="workphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span >
                                <div class="invalid-feedback"></div>   
            
                            </div>
                            <div class=" col-sm-12 col-md-3 col-lg-4">
                                <input id="mphone"  type="text" pattern="[0-9]{10}" class="form-control bg-light text-dark mt-2"  name="m_phone" placeholder="mobile number" required>
                                <span id="phone-message" class="mt-2 " style="font-size: 10px;"></span >
                                <span id="mphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span >
                                <div class="invalid-feedback"></div>   
            
                            </div>
        
                            <hr style="border: none; height: 2px; background-color: #ffcc00; margin: 20px 0;">
        
                            <div class="toggle1 section-toggle">
                                <a href="">More Details</a>
        
                            </div>
        
        
                        </div>
                        
        
                        <fieldset1 id="more_detail" class="more details" style="display: none;">
        
                            <div class="form-group row mt-4">
                                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                                    <label>Skype name/Number</label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <input  type="text" class="form-control bg-light text-dark" name="skype_number">      
                                </div>
        
                            </div>
        
                            <div class="form-group row mt-4">
                                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                                    <label>Designation</label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <input  type="text" class="form-control bg-light text-dark" name="designation">      
                                </div>
        
                            </div>
        
                            <div class="form-group row mt-4">
                                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                                    <label>Department</label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <input  type="text" class="form-control bg-light text-dark" name="department">      
                                </div>
        
                            </div>
        
        
                   
                        <div class="form-group row mt-4">
                            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Website</label></div>
                            <div class="col-sm-12 col-md-6 col-lg-6">
                                <input id="web" type="text" class="form-control bg-light text-dark" onclick="mobile_phone()"    name="website">      
                            </div>
                        </div>
                    </fieldset1>
        
        
                        <hr style="border: none; height: 2px; background-color: #ffcc00; margin: 20px 0;">
        
                        <div class="section-3">
        
                            <div class="toggle2 section-toggle"> <a href="" >Other Details </a> </div>
                            <div class="toggle3 section-toggle" > <a href="">Address </a> </div>
                            <div class="toggle4 section-toggle"><a href="" >Contact Persons </a></div>
                            <div class="toggle7 section-toggle"><a href="">Remarks</a></div>
        
                        </div>
        
                       
                        <fieldset2 class="other details">
        
                            <div class="form-group row mt-2">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > GST Treatment*</label>
                                
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <select name="gst" id="GSTT" class="form-control bg-light text-dark" onclick="gstPan_function()">
                                        <option value="Select a Gst Treatment" selected>Select a Gst Treatment</option>
                                        <option value="Registered Business-Regular Business that is registered under GST">Registered Business-Regular Business that is registered under GST</option>
                                        <option value="Registered Business-Composition Business that is registered under the Composition scheme in GST">
                                            Registered Business-Composition Business that is registered under the Composition schemen in GST
                                        </option>
                                        <option value="Unregistered Business-not Registered under GST">Unregistered Business-not Registered under GST</option>
                                        <option value="Overseas- Persons with who you do import or exports of supplies outside india">Overseas- Persons with who you do import or exports of supplies outside india</option>
                                        <option value="Special Economic Zone">Special Economic Zone</option>
                                    </select><br>
                                </div>
        
        
                            </div>
        
                            <fieldset3 id="gst" style="display: none;">
                                <div class="row mt-4">
                                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white"  > GSTIN/UIN*</label>
                                    
                                    <div class=" col-sm-12 col-md-3 col-lg-3">
                                        <input type="text" class="form-control bg-light text-dark" name="gst_number" id="gstInput" > 
                                        <span id="gstMessage"></span>       
                
                                    </div>
                
                
                                </div>
        
                            </fieldset3>
        
                            <fieldset4 id="pan" style="display: none;">
                                <div class=" row mt-4">
                                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > PAN</label>
                                    
                                    <div class=" col-sm-12 col-md-3 col-lg-3">
                                        <input type="text" class="form-control bg-light text-dark"  id="panInput"  name="pan_number">  
                                        <span id="panMessage"></span>    
        
                
                                    </div>
                
                
                                </div>
        
                            </fieldset4>
        
        
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Source Of Supply*</label>
                                
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <select name="source_supply" id="PLACE" class="form-control bg-light text-dark">
                                        <option value="value" selected></option>
                                        <option value="[AN]-Andaman And Nicobar Islands">[AN]-Andaman And Nicobar Islands</option>
                                        <option value="[AD]-Andhra Pradesh">[AD]-Andhra Pradesh</option>
                                        <option value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh	</option> 
                                        <option value="volvo">[AS]-Assam</option>
                                        <option value="[BR]-Bihar">[BR]-Bihar</option> 
                                        <option value="volvo">[CH]-	Chandhigarh</option>
                                        <option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
                                        <option value="[DD]-Daman Diu">[DD]-Daman Diu</option>
                                        <option value="volvo">[DL]-	Delhi</option>
                                        <option value="[GA]-Goa">[GA]-Goa</option> 
                                        <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
                                        <option value="[HR]-Haryana">[HR]-Haryana</option> 
                                        <option value="[HP]-Himachal Pradesh">[HP]-Himachal Pradesh</option>
                                        <option value="[JK]-Jammu And Kashmir">[JK]-Jammu And Kashmir</option>
                                        <option value="[JH]-Jharkand">[JH]-Jharkand</option>
                                        <option value="[KA]-Karnataka">[KA]-Karnataka</option>
                                        <option value="[KL]-Kerala">[KL]-Kerala</option>
                                        <option value="[LA]-Ladakh">[LA]-Ladakh</option>
                                        <option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
                                        <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option>
                                        <option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
                                        <option value="[MN]-Manipur">[MN]-Manipur</option>  
                                        <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
                                        <option value="[MZ]-Mizoram">[MZ]-Mizoram</option>
                                        <option value="[NL]-Nagaland">[NL]-Nagaland</option> 
                                        <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                                        <option value="[OD]-Odisha">[OD]-Odisha</option>
                                        <option value="[PY]-Puducherry">[PY]-Puducherry</option>
                                        <option value="[PB]-Punjab">[PB]-Punjab.</option>
                                        <option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
                                        <option value="[SK]-Sikkim">[SK]-Sikkim</option>
                                        <option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
                                        <option value="[TS]-Telenghana">[TS]-Telenghana</option>
                                        <option value="[TR]-Tripura">[TR]-Tripura</option>
                                        <option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
                                        <option value="[UK]-Utharakhand">[UK]-Utharakhand</option>
                                        <option value="[WB]-West Bengal">[WB]-West Bengal</option>
                                        <option value="[OT]-Other Territory">[OT]-Other Territory</option>
                                    </select>
                                </div>
            
            
                            </div>
                            
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Currency*</label>
                                
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <select name="currency" id="PLACE" class="form-control bg-light text-dark">
                                        <option value="Indian Rupee" selected>Indian Rupee</option>
                                        <option value="Indian Rupee">Indian Rupee</option>
                            
                                    </select>
                                </div>
            
            
                            </div>
        
                            <div class="form-group row mt-2">
                                <div class="col-sm-12 col-md-3 col-lg-3 ">
                                   <label class="col-form-label text-white mb-3"> Opening Balance Type</label>
                                </div>
                                <div class="col-sm-12 col-md-3 col-lg-4 d-flex align-items-center">
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="op_type" id="debit" value="debit">
                                        <label class="form-check-label text-white" for="debit">Debit</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="op_type" id="credit" value="credit">
                                        <label class="form-check-label text-white" for="credit">Credit</label>
                                    </div>
                                </div>
                            </div>
        
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Opening Balance Amount</label>                    
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <input  type="number" class="form-control bg-light text-dark" name="opening_bal" value="0.00">      
                                </div>
                            </div>
                            
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Payment Terms</label>
                                
                                <div class=" col-sm-12 col-md-3 col-lg-3">
                                    <select name="payment_terms" id="paytearm-select" class="form-control bg-light text-dark">
                                       
        
                                        {% for pay_terms in payments %}
                                        <option value="{{pay_terms.id}}" >{{pay_terms.term_name}}</option>
                                    {% endfor %}
                                        
                                    </select>
        
                                </div>
            
                                <div class="col-md-4 ">
                                    <a href="#" class="btn btn-outline-secondary py-2 my-1" data-target="#newpayment" data-toggle="modal" style="color: white; background-color: rgb(210, 132, 30);" >+</a>
                                </div>
                            
        
        
        
            
                            </div>
        
                
                        </fieldset2>
        
        
                        <!------------------ Address Section Start------------- -->
        
                        <fieldset5 id="address" style="display: none;">
                            <div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-6 col-lg-6">
                                        <div class="row">
                                            <div class="col-sm-12 col-md-6 col-lg-6">
                                                <label for="">BILLING ADDRESS</label>
                                            </div>
                                            <div class="col"></div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Attention</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="text" class="form-control bg-light text-dark" name="battention" id="batten">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Country</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <select name="bcountry" id="btry" class="form-control bg-light text-dark">
                                                    <option value="India" selected>India</option>
                                                </select>      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Address</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <textarea class="form-control bg-light " style="border: none;color: rgb(7, 7, 7);" cols="26" rows="4" name="baddress" id="badd1"></textarea>
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > City</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="text" class="form-control bg-light text-dark" name="bcity" id="bcty">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > State</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input type="text" class="form-control bg-light text-dark" name="bstate" id="bste">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Zip Code </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="number" class="form-control bg-light text-dark" name="bzip" id="bzp">      
                                            </div>
                                        </div>
                                    
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Phone </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input id="bphone_num"  type="tel" pattern="[0-9]{10}" class="form-control bg-light text-dark" name="bphone" >
                                                <label for="" id="bphone_label"></label>      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Fax </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" onmouseout="fax_number()"  onclick="bphone_number()"                                       name="bfax" id="bfx">  
                                            
                                                <label for="" id="fax_label"></label> 
                                            </div>
                                        </div>
        
                                    </div>
                                    <div class="col-sm-12 col-md-6 col-lg-6">
                                        <div class="row">
                                            <div class="col-sm-12 col-md-6 col-lg-6">
                                                <label for="">SHIPPING ADDRESS</label>
                                            </div>
                                            <div class="col-sm-12 col-md-6 col-lg-6">
                                                <input  type="checkbox" id="myCheckT" onclick="myCopyAddressFunction()">&nbsp;
                                                <label for="myCheck">Same as Billing Address:</label>
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Attention</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="text" class="form-control bg-light text-dark " style="color: white;" name="sattention" id="satten">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Country</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <select name="s_country" id="sctry" class="form-control bg-light text-dark">
                                                    <option value="India" selected>India</option>
                                                </select>      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Address</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <textarea class="form-control bg-light" style="border: none;color: rgb(10, 10, 10);" id="sadd1" cols="26" rows="4" name="saddress"></textarea>
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > City</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="text" class="form-control bg-light text-dark" name="scity" id="scty">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > State</label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input type="text" class="form-control bg-light text-dark" name="sstate" id="sste">      
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Zip Code </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="number" class="form-control bg-light text-dark" name="szip" id="szp">      
                                            </div>
                                        </div>
                                    
        
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Phone </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{10}" style="color: white;" name="sphone" id="sphone_num">  
                                                <label for="" id="sphone_label"></label>    
                                            </div>
                                        </div>
                                        <div class="form-group row mt-4">
                                            <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Fax </label>                    
                                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                                <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" style="color: white;" name="sfax" onclick="sphone_number()" onmouseout="sfax_number()" id="sfx"> 
                                                <label for="" id="sfax_label"></label>     
                                            </div>
                                        </div>
        
                                    </div>
                                </div>
                            </div>
                        </fieldset5>
        
                        <!---------------------Address  Section End -------------->
        
        
                        <!------------------ Contact Person Section Start------------- -->
        
                        <fieldset6 id="contact_person" style="display: none;" >
                            <div class="row">
                                <div class="col-sm-12 ">
                                    
                                    <div class="table-responsive">
                                    
                                        <table id="tbl" class="table text-white" style="background-color: rgba(250, 227, 198, 0.5);">
                                            <thead>
                                                <tr>
                                                    
                                                <th>Salutation</th>
                                                <th>First Name</th>
                                                <th>Last Name</th>
                                                <th>Email Address</th>
                                                <th >Work Phone <br><span id="twph_label"></span></th>
                                                <th >Mobile <br><span id="tlabel"></span>    </th>
                                                <th >Skype Name/No</th>
                                                <th >Designation</th>
                                                <th >Department</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                            <td><select name="salutation[]" class="form-control bg-transparent border-1 text-white"  id="PLACE" >
                                                <option class="text-dark"  >Select</option>
                                                <option class="text-dark" value="Mr" >Mr.</option>
                                                <option class="text-dark" value="Mrs">Mrs.</option>
                                                <option class="text-dark" value="Ms">Ms.</option>
                                                <option class="text-dark" value="Miss">Miss.</option>
                                                <option class="text-dark" value="Dr">Dr.</option>
                                                </select></td>
                                            <td><input type="text" class=" form-control border-1 bg-transparent text-white"    name="first_name[]"  ></td>
                                            <td><input type="text"class="form-control border-1 bg-transparent text-white"  name="last_name[]" /></td>
                                            <td>
                                                <input type="text" class="form-control border-1 bg-transparent text-white" name="email[]" />
                                                
                                                
                                            </td>
                                            
                                            <td>
                                                <input type="tel" pattern="[0-9]{7}" class="form-control border-1 bg-transparent text-white"  id="twphone" name="wphone[]"/>
                                               
                                            </td>
                                            <td>
                                                <input type="tel" pattern="[0-9]{10}"  class="form-control border-1 bg-transparent text-white"  id="tmobile" onclick="sample1()"   name="mobile[]" />
                                                
                                            </td>
                                            <td><input type="number" class="form-control border-1 bg-transparent text-white"  onclick="sample()" name="skype[]" /></td>
                                            <td><input type="text" class="form-control border-1 bg-transparent text-white"  name="designation[]" /></td>
                                            <td><input type="text" class="form-control border-1 bg-transparent text-white"  name="department[]" /></td>
                                            </tr>
                                        </tbody>
                                        </table>
                                        
                                    </div>
                                    
                                    <div class="button add_another mt-3 ">
                                        <i class="fa fa-user-plus" aria-hidden="true"></i> 
                                        <span class="text-small" style="margin-left: 0.30rem;">
                                            Add Contact Person
                                        </span>
                                    </div>
                                       
                                    
                                </div>
                                
                            </div>
        
                        </fieldset6>
        
                        <!---------------------Contact Person Section End -------------->
        
        
                        <!------------------ Remark Section Start------------- -->
        
                        <fieldset7 class="remarks" style="display: none;">
                            <div class="row">
                                <div class="col-sm-12 col-md-8 col-lg-8">
                                    <div class="form-group row mt-4">
                                        <div class=" col-sm-12 col-md-6 col-lg-6">
                                            <textarea class="bg-light w-100" style="border: none;color: rgb(5, 5, 5);"   rows="5" name="remark"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-12 col-md-2 col-lg-2"></div>
                            </div>
        
                        </fieldset7>
        
                        <!---------------------Remark Section End -------------->
                        
                        <div class="row mt-5">
                            <div class="col-sm-12 col-md-2 col-lg-2 mt-3">
                                <button type="submit" class="btn btn-outline-warning form-control bg-warning text-dark" style="font-weight: bold;">Save</button>
                               
                            </div>
                            
                            <div class=" col-sm-12 col-md-2 col-lg-2 mt-3">
                                <button type="reset" class="form-control  bg-warning text-dark" style="font-weight: bold;">Cancel</button>
                               
                            </div> 
        
        
                        </div>
        
               
        
                    </form>
                </div>
            </div>
        </div>   
    </div>
</div>


<!-- Item Unit Create Modal -->

<div class="modal fade" id="newunit">
    <div class="modal-dialog">
        <div class="modal-content" style="background-color: #0c1216;">
            <div class="modal-header">
                <h5 class="m-3">New Item Unit</h5>
                <button type="button" class="close" data-toggle="modal" data-target="#newitem" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class=" p-3">
                    <form method="post" id="newUnitForm">
                        {% csrf_token %}
                        <div class="row mt-2">
                            <div class="col-12">
                                <label for="name">Unit Name</label>
                                <input name="name" id="unit_name" class="form-control text-uppercase w-100">
                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="col-12 d-flex justify-content-center">
                                <button class="btn btn-outline-warning text-grey" data-toggle="modal" data-target="#newitem" type="button" id="saveItemUnit">Save</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>   
    </div>
</div>


<!-- Account Create Modal -->

<div class="modal fade" tabindex="-1" role="dialog" id="createNewAccount">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content" style="background-color: #060a0e;">
            <div class="modal-header">
                <h5 class="m-3">New Account</h5>
                <button type="button" class="close" data-toggle="modal" data-target="#newitem" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class=" p-3">
                    <form method="post" id="newAccountForm">
                        {% csrf_token %}
                        <div class="row mt-2 mb-2">
                            <div class="col-md-6">
                                <div class="row mt-2">
                                    <div class="col-12">
                                        <label for="acctyp">Account Type</label>
                                        <input type="text" value="Assets" id="acctype" name="acctype" hidden>
                                        <select name="account_type" id="Account_type" class="custom-select-md form-control w-100"  onchange="AccountTypeChange(this)" required>
                                            <optgroup label="Expense" style="background-color: rgb(10, 16, 21);">
                                                <option value="Expense"> Expense </option>
                                                <option value="Cost Of Goods Sold"> Cost Of Goods Sold </option>
                                                <option value="Other Expense"> Other Expense </option>
                                            </optgroup>
                                        </select>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-12">
                                        <label for="name">*Name</label>
                                        <input name="account_name" id="accountName" required class="custom-select-md form-control w-100">
                                    </div>
                                </div>
                                <div class="row mt-1" id="subAccountCheck" style="display: none;">
                                    <div class="col-12">
                                        <div class="form-check">
                                            <input type="checkbox" name="subAccountCheckBox" class="form-check-input" id="subAccountCheckBox">
                                            <label class="form-check-label" for="subAccountCheckBox">Make this a sub-account</label>
                                            <span><i class="fa fa-question-circle" data-toggle="tooltip" data-placement="bottom" title="Select this option if you are creating a sub-account."></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-2" id="parentAccountValue" style="display: none;">
                                    <div class="col-12">
                                        <label for="parentAccount">Parent Account</label>
                                        <select name="parent_account" id="parentAccount" class="custom-select-md form-control w-100">
        
                                        </select>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-12">
                                        <label for="acc_code">Account Code</label>
                                        <input type="text" name="account_code" id="account_code" class="form-control">
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-12">
                                        <label>Description</label>
                                        <textarea class="form-control" rows="3" id="description" name="description" placeholder="Max. 500 Characters"></textarea>
                                    </div>
                                </div>
                                
                            </div>
                            <div class="col-md-6 mt-4"> 
                                <div id="acnt-desc" class="form-control" name="detype" style="font-size: small;  height: fit-content;"></div>
                            </div>
                        </div>
                            
                        <div class="mt-3">
                            <div class="row">
                                <div class="col-md-4"></div>
                                <div class="col-md-4 d-flex justify-content-center">
                                    <button type="button" data-toggle="modal" data-target="#newItem" id="saveNewAccount" class="btn btn-outline-warning">Save</button>
                                </div>
                                <div class="col-md-4"></div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>   
    </div>
</div>


<!-- New Item Modal -->

<div class="modal fade" id="newitem">
    <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background-color: #060a0e;">
            <div class="modal-header">
                <h5 class="m-3 text-white">New Item</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class=" p-3">
                    <form method="post" id="newItemForm">
                        {% csrf_token %}

                        <div class="row">
                            <div class="col-md-6 mt-3">
                                <label for="itemName" style="color: white;">Name</label>
                                <input type="text" id="itemName" name="name" class="form-control" style="background-color: #0d1115; color: white;" autocomplete="off" required>
                            </div>
                            <div class="col-md-6 mt-3">
                                <label for="itemType" style="color: white;">Type</label>
                                <select name="type" class="form-control" id="itemType" style="background-color: #0d1115; color: white;" required>
                                    <option selected disabled value="">Choose...</option>
                                    <option value="Goods">Goods</option>
                                    <option value="Services">Services</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mt-3">
                                <label for="itemUnit" style="color: white;">Unit</label>
                                <div class="d-flex">
                                    <select class="custom-select" name="unit" id="itemUnit" required style="background-color: #0d1115; color: white;">
                                        <option selected disabled value="">Choose...</option>
                                        {% for a in units %}
                                        <option class="text-uppercase">{{ a.unit_name }}</option>
                                        {% endfor %}
                                    </select>
                                    <a href="#">
                                        <button type="button" class="btn btn-outline-warning ml-1" data-dismiss="modal" data-toggle="modal" data-target="#newunit">+</button>
                                    </a>
                                </div>
                            </div>
                            <div class="col-md-6 mt-3">
                                <label for="hsnField" style="color: white;">HSN Code</label>
                                <input type="number" name="hsn" class="form-control" style="background-color: #0d1115; color: white;" placeholder="Enter a valid HSN code" required id="hsnField" oninput="validateHSN()">
                                <div id="hsnError" style="color: red;"></div>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-12 mt-3">
                                <label style="color: white;">Tax Reference</label>
                            </div>
                            <div class="col-md-3">
                                <div class="form-check mt-1">
                                    <input class="form-check-input" name="taxref" type="radio" id="inclusive" value="taxable" onclick="showdiv()" required>
                                    <label style="color: white;" for="inclusive">taxable</label>
                                </div>
                            </div>
                            <div class="col-md-3">
                              <div class="form-check mt-1">
                                  <input class="form-check-input" name="taxref" type="radio" value="non taxable" id="check" onclick="hidediv()">
                                  <label style="color: white;" for="check">non taxable</label>
                              </div>
                           </div>
                        </div>
                        <div class="row"  id="taxableDiv" style="display: none;">
                            <div class="col-md-6 mt-3">
                                <label for="intraStateTax" style="color: white;">Intra State Tax Rate</label>
                                <select name="intra_st" class="form-control" style="background-color: #0d1115; color: white;" id="intraStateTax" >
                                    <option value=0>GST 0 (0%)</option>
                                    <option value=3>GST 3 (3%)</option>
                                    <option value=5>GST 5 (5%)</option>
                                    <option value=12>GST 12 (12%)</option>
                                    <option value=18>GST 18 (18%)</option>
                                    <option value=28>GST 28 (28%)</option>        
                                </select>
                            </div>
                            <div class="col-md-6 mt-3">
                                <label for="interStateTax" style="color: white;">Inter State Tax Rate</label>
                                <select name="inter_st" class="form-control" style="background-color: #0d1115; color: white;" id="interStateTax" >
                                    <option value=0>IGST 0 (0%)</option>
                                    <option value=3>IGST 3 (3%)</option>
                                    <option value=5>IGST 5 (5%)</option>
                                    <option value=12>IGST 12 (12%)</option>
                                    <option value=18>IGST 18 (18%)</option>
                                    <option value=28>IGST 28 (28%)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mt-3">
                                <label style="color: white;">Purchase Price</label>
                                <div class="row">
                                    <div class="col-md-12 d-flex">
                                        <input type="text" class="form-control mr-1" value="INR" style="width:60px;background-color: #0d1115; color: white;">
                                        <input type="number" name="pcost" class="form-control" id="purprice" style="background-color: #0d1115; color: white;" value="0">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 mt-3">
                                <label style="color: white;">Sales Price</label>
                                <div class="row">
                                    <div class="col-md-12 d-flex">
                                        <input type="text" class="form-control mr-1" value="INR" style="width:60px;background-color: #0d1115; color: white;">
                                        <input type="text" name="salesprice" class="form-control" id="saleprice" style="background-color: #0d1115; color: white;" value="0">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mt-3">
                                <label for="purchaseAccount" style="color: white;">Account</label>
                                <div class="d-flex">
                                    <select name="pur_account" class="form-control" style="background-color: #0d1115; color: white;" id="purchaseAccount">
                                        <option value="" selected disabled>--Choose--</option>
                                        {% for a in accounts %}
                                        <option value="{{ a.account_name }}">{{ a.account_name }}</option>
                                        {% endfor %}
                                    </select>
                                    <button type="button" data-dismiss="modal" data-toggle="modal" data-target="#createNewAccount" class="btn btn-outline-warning ml-1" id="openAccountModal">+</button>
                                </div>
                            </div>
                            <div class="col-md-6 mt-3">
                                <label for="salesAccount" style="color: white;">Account</label>
                                <select name="sale_account" class="form-control" style="background-color: #0d1115; color: white;" id="salesAccount">
                                    <option value="" selected disabled>--Choose--</option>
                                    <option value="General Income">General Income</option>
                                    <option value="Interest Income">Interest Income</option>
                                    <option value="Late Fee Income">Late Fee Income</option>
                                    <option value="Discount Income">Discount Income</option>
                                    <option value="Shipping Charges">Shipping Charges</option>
                                    <option value="Other Charges">Other Charges</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mt-3">
                                <label for="purchaseDescription" style="color: white;">Description</label>
                                <textarea class="form-control" name="pur_desc" id="purchaseDescription" style="background-color: #0d1115; color: white;"></textarea>  
                            </div>
                            <div class="col-md-6 mt-3">
                                <label for="salesDescription" style="color: white;">Description</label>
                                <textarea class="form-control" name="sale_desc" id="salesDescription" style="background-color: #0d1115; color: white;"></textarea>
                            </div>
                        </div>
                                    
                        <div class="row mt-3" >
                            <div class="col-md-3">
                                <div class="form-check">
                                    <input class="form-check-input" onclick="ShowHideDiv(this)" type="checkbox"  id="track">
                                    <label class="form-check-label" for="track">Track Inventory</label>
                                </div>  
                            </div>
                        </div>
                        <div class="row" id="inventorytrack" style="display: none">
                            <div class="col-md-6 mt-3">
                                <label style="color: white;">Inventory Account</label>
                                <select name="invacc" id="invAcc" class="form-control" style="background-color: #0d1115; color: white;">
                                    <option selected disabled value="" >Choose...</option>
                                    <option value="Inventory Assets">Inventory Assets</option>    
                                </select>
                            </div>
                            <div class="col-md-3 mt-3">
                                <label style="color: white;">Stock on hand</label>
                                <input type="number" name="stock" id="stockOnHand" class="form-control" style="background-color: #0d1115; color: white;" value="0">
                            </div>
                            <div class="col-md-3 mt-3">
                                <label style="color: white;">Stock Rate per Unit</label>
                                <input type="number" id="stockRate" name="stock_rate" class="form-control" style="background-color: #0d1115; color: white;" value="0">
                            </div>
                        </div>

                        <div class="row" >
                            <div class="col-md-3 mt-3">
                                <label style="color: white;">Minimum Stock to maintain</label>
                                <input type="number" id="minStock" name="min_stock" class="form-control" style="background-color: #0d1115; color: white;" value="0">
                            </div>
                        </div>

                        <div class="row mt-4">
                            <div class="col-4"></div>
                            <div class="col-4 d-flex justify-content-center">
                                <button class="btn btn-outline-warning text-grey w-75" data-dismiss="modal" type="submit" id="saveNewItem">Save</button>
                            </div>
                            <div class="col-4"></div>
                        </div>
                    </form>
                </div>
            </div>
        </div>   
    </div>
</div>



<!--------------- Payments Seciton Start ----------------->

<div class="modal fade" id="newpayment">
    <div class="modal-dialog modal-md">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
        <div class="modal-header " style="background: rgb(32, 35, 37);">
            <h3 class="m-3 text-uppercase" style="color: white;">Add Payment Term</h3>
            <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3" style="background-color: #141414a2;">
            <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalPayment_terms">
            


            <div class="row mt-2">

                <div class="col-lg-12 col-md-12 col-sm-12 mt-2">
                    <label for="termname" style="color: white">Term Name *</label>

                <input type="text " class="form-control text-dark bg-light mt-2" id="tname" name="term_name" autocapitalize="characters" required> 
                <span id="message-id" class="mt-1 text-danger" style="font-size: 10px;"></span> 
                <span id="success-message-id" class=" mt-1 text-success" style="font-size: 10px;"></span>    
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 mt-2">
                    <label for="termdays" style="color: white">Number of Days *</label>

                <input type="number" class="form-control text-dark bg-light mt-2" id="tdays" name="term_days" autocapitalize="characters" required>
                </div>
                <div class="col-md-2 mt-2"></div>

            </div>
            
            <div class="row mt-5">
                <div class="col-lg-12 col-md-12 col-sm-12">
                <div class="d-flex">
                    <button class="btn save_btn rounded-pill text-grey w-50 my-1 mx-1 btn-outline-warning "
                    type="submit" data-dismiss="modal" id="termSave">Save
                    </button> 
                    

                    <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-1 mx-1 btn-outline-warning" 
                    data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">Cancel</span>
                    </button>
                </div>
                </div>
            </div>
            </form>
        </div>
        </div>
    </div>
    </div>  
</div> 

<!------------------- Payments  Section End -------------->





<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>




  
  <script>
      $(document).ready(function () {
          $('#customer').selectize({
              sortField: 'value'
          });
      });
      
  
      function refreshCustomerDetails(){
          console.log($('#customer').text());
          if($('#customer').val() != 0){
              $('#custErr').text('');
              $.ajax({
                  type : 'POST',
                  url: "{% url 'getInvoiceCustomerData' %}",
                  data: {
                      id: $('#customer').val(),
                      csrfmiddlewaretoken: '{{ csrf_token }}',
                  },
                  
                  success: function(data){
                      console.log('AJAX-Response-->',data);
                      document.getElementById('customerEmail').value = data.email;
                      var placeOfSupplySelect = document.getElementById('placeOfSupply');
                      var newOption = new Option(data.shipState, data.shipState); // Create a new option element
                      placeOfSupplySelect.appendChild(newOption); // Append the new option to the select element
                      placeOfSupplySelect.value = data.shipState; // Set the value of the select element to the desired value
                     
                      document.getElementById('gstType').value = data.gstType;
                      document.getElementById('billAddress').value = data.street + '\n' + data.city + '\n' + data.state + '\n' + data.country  + '\n' + data.pincode ;
                      if(data.gstin){
                          document.getElementById('gstInDisplay').style.display = 'block';
                          document.getElementById('gstin').value = data.gstNo;
                      }else{
                          document.getElementById('gstInDisplay').style.display = 'none';
                          document.getElementById('gstin').value = '';
                      }
                      $('#applyPriceList').prop('checked') ? $('#applyPriceList').prop('checked', false) : $('#applyPriceList').prop('checked',false);
                      if(data.priceList){
                          $('#applyPriceListSection').show();
                          $('#customerPriceListId').val(data.ListId);
                          $('#custPriceListName').text('Applied: '+data.ListName)
                      }else{
                          $('#applyPriceListSection').hide();
                          $('#customerPriceListId').val("");
                      }
  
                      refreshTax();
                      checkPriceList();
                  }
              });
          }else{
              document.getElementById('customerEmail').value = "";
              document.getElementById('placeOfSupply').value = "";
              document.getElementById('gstType').value = "";
              document.getElementById('billAddress').value ="";
              document.getElementById('gstin').value = "";
              $('#customerPriceListId').val("");
              $('#custErr').text('Select a customer..');
          }
      }
  
      $(document).ready(function () {
          $('#customer').on('change', function() {
              refreshCustomerDetails();
          });
      });
  
    //   $(document).on("click","#savePaymentTerm",function(){
    //       var trm = $('#termName').val();
    //       var dys = $("#termDays").val();
    //       if (trm !="" && dys !=""){
    //           $.ajax({
    //               type : 'POST',
    //               url:"{% url 'newCustomerPaymentTerm' %}",
    //               data:{
    //                   'term' : trm,
    //                   'days' : dys,
    //                   csrfmiddlewaretoken: '{{ csrf_token }}'
    //               },
                  
    //               success: function(response) {
    //                   if(response.status){
    //                       document.getElementById("newTermForm").reset();
                          
    //                       var dropdown = $('#paymentTerm');
    //                       dropdown.empty();
    //                       dropdown.append(`<option value="" selected>Choose</option>`);
    //                       $.each(response, function(key, value) {
    //                           for(let i=0; i<value.length; i++){
    //                               if(value[i].name == trm){
    //                                   dropdown.append($('<option selected></option>').attr('text',value[i].days).text(value[i].name).val(value[i].id))
    //                               }else{
    //                                   dropdown.append($('<option></option>').attr('text',value[i].days).text(value[i].name).val(value[i].id))
    //                               }   
    //                           }
    //                       });
  
    //                       findDueDate();
  
    //                   }else{
    //                       alert("Something went wrong.!")
    //                   }
    //               },         
    //           });
    //       }
    //       else{
    //           alert('Invalid')
    //       }
    //   });
  
      function findDueDate(){
          var days = parseInt($('#paymentTerm').find(":selected").attr('text'))
          order_date =new Date($('#invoiceDate').val())
          console.log(days);
          console.log(order_date);
          if (!isNaN(order_date.getTime())) {
  
              const endDate = new Date(order_date);
              endDate.setDate(endDate.getDate() + days);
  
              const isoString = endDate.toISOString(); 
              const day = isoString.slice(8, 10);
              const month = isoString.slice(5, 7);
              const year = isoString.slice(0, 4);
  
              const formattedDate = `${year}-${month}-${day}`;
  
              document.getElementById("dueDate").value = formattedDate;
          } else {
                  alert("Please enter a valid date.");
                  $('#paymentTerm').val('')
          }
      }
  
      $('#paymentTerm').on('change', function () {
          findDueDate();
      });
  
      $('#invoiceDate').on('change', function() {
          findDueDate();
      });
  

      $(document).ready(function() {
        $("#paymentMethod").change(function() {
            var x=$('#paymentMethod').val();
            if(x==='Cash'){
                $('#chequediv').hide()
                $('#bnkdiv').hide()
                $('#upidiv').hide()
                document.getElementById('cheque_id').value=""
                document.getElementById('upi_id').value=""
                document.getElementById('bnk_id').value=""
            }else if(x==='Cheque'){
                $('#chequediv').show()
                $('#bnkdiv').hide()
                $('#upidiv').hide()
                document.getElementById('upi_id').value=""
                document.getElementById('bnk_id').value=""
            }else if(x==='UPI'){
                $('#upidiv').show()
                $('#bnkdiv').hide()
                $('#chequediv').hide()
                document.getElementById('cheque_id').value=""
                document.getElementById('bnk_id').value=""
            }else{
                $('#bnkdiv').show()
                $('#chequediv').hide()
                $('#upidiv').hide()
                document.getElementById('cheque_id').value=""
                document.getElementById('upi_id').value=""

                $.ajax({
                    type: "GET",
                    url: "{% url 'getBankAccount' %}",
                    
                    data: {
                        id: $('#paymentMethod').find(':selected').attr('text'),
                    },
                    
                    success: function (response) {
                        if (response.status){
                            document.getElementById('cheque_id').value="";
                            document.getElementById('upi_id').value="";
                            document.getElementById("bnk_id").value = response.account;
                        }else{
                            alert(response.message);
                        }
                    }
                });
            }
        });
    });


  $(document).on('change','#placeOfSupply',function()   {
    refreshTax();
    calc();
});

function filterFunction(id){
    var options = $('#'+ $("#"+id).next().attr('id')).children();
    var search_text = $("#"+id).val().toLowerCase();
    options.each(function(){
        if($(this).text().toLowerCase().includes(search_text)){
            $(this).show()
        }else{
            $(this).hide()
        }
    })
}

function getItemDetails(inpId, value){
    var itm = value;
    var exists = false;
    var plc = $('#place_of_supply').val();
    var PLId = $('#customerPriceListId').val();
    console.log('clicked',value);

    $('#items-table-body tr').each(function () {
        var html = $(this).html();
        if (html != '') {
            var itemName = $(this).find('.item-display').val();
            console.log(itm,itemName);
            if(itemName == itm){
                exists = true;
                console.log('exists',exists);
            }
        }
    });
    console.log('status',exists);

    if(!exists){
        if(plc != ""){
            var n = inpId.slice(4);
            $.ajax({
            url: "{% url 'getInvItemDetails' %}",
            type : 'GET',
            data:{
                item : value,
                csrfmiddlewaretoken: '{{ csrf_token }}'
                },
            
            success: function(response) {
                if (response.status){
                    $('#'+inpId).val(value);
                    document.getElementById('itemId'+n).value = response.id;
                    document.getElementById('hsn'+n).value = response.hsn;
                    document.getElementById('qtyspan'+n).innerHTML = response.avl;
                    document.getElementById('avl'+n).innerHTML = response.avl;
                    document.getElementById('price'+n).value = response.sales_rate;
                    document.getElementById('priceListPrice'+n).value = response.PLPrice;
                    document.getElementById('taxGST'+n).value = response.gst;
                    document.getElementById('taxIGST'+n).value = response.igst;
                    

                    refreshTax();
                    calc();
                }
            },
            });
        }else{
            alert('Select Place of Supply.!')
        }
    }else{
        alert('Item already exists in the INVOICE, choose another or change quantity.!')
    }

}
function refreshTax(){
  var cmpState = $('#state1').val();
  var plc = $('#placeOfSupply').val();

  if(cmpState == plc){
      $('.tax_ref').css('display','none');
      $('.tax_ref_gst').css('display','block');
      document.getElementById('taxamountCGST').style.display = 'flex';
      document.getElementById('taxamountSGST').style.display = 'flex';
      document.getElementById('taxamountIGST').style.display = 'none';
  }else{
      $('.tax_ref').css('display','none');
      $('.tax_ref_igst').css('display','block');
      document.getElementById('taxamountCGST').style.display = 'none';
      document.getElementById('taxamountSGST').style.display = 'none';
      document.getElementById('taxamountIGST').style.display = 'flex';
  }
}
$(document).on('change','#invoiceNumber', function() {
    $('#invNoErr').text('');
    var inv_num = $(this).val();
    if(inv_num != ""){
        console.log(inv_num);
        $.ajax({
            type: "GET",
            url: "{% url 'checkInvoiceNumber' %}",
            data: {
                invNum : inv_num,
            },
            success: function (response) {
                if (response.status){
                    $('#invNoErr').text('');
                }else{
                    $('#invNoErr').text(response.message);
                }
            }
        })
    }
});
function changeItemQty(id){
    id_val = id.slice(3)
    var qty = document.getElementById(id).value;
    var avl_val = document.getElementById(`avl${id_val}`).innerText;

    if( parseInt(qty) > parseInt(avl_val) ){
        alert("Quantity Greater than Available Quantity")
        document.getElementById(id).value = avl_val;
        calc()
    }else{
        document.getElementById(`qtyspan${id_val}`).textContent = parseInt(avl_val) - parseInt(qty);

    }
}

$(document).ready(function(){
    $('#items-table-body').on('keyup change', function () {
        refreshTax();
        calc()
    });
});

$(document).ready(function(){
    $(document).on("blur", ".disc", function(){
        if($(this).val() != ""){
        }else{
        $(this).val(0);
        calc()
        }
    }); 
});

// calculation---------------------------

function calc() {
    $('#recurr_item_tabel tbody tr').each(function () {
        var html = $(this).html();
        if (html != '') {
            var qty = $(this).find('.qty').val();
            if($('#applyPriceList').prop('checked')){
                var price = $(this).find('.priceListPrice').val();
            }else{
                var price = $(this).find('.price').val();
            }
            var dis = $(this).find('.disc').val();
            var bc = $("#placeOfSupply").val();
            var compstate = $("#state1").val();

            if(bc==compstate){
                var tax = $(this).find('.tax_ref_gst').val();
            }
            else{
                var tax = $(this).find('.tax_ref_igst').val();
            }
            
            var total_amnt = (parseFloat(qty) * parseFloat(price)) - parseFloat(dis)

            $(this).find('.total').val(total_amnt);
            $(this).find('.itemTaxAmount').val(((qty * price)-dis) * (tax / 100));

            var self = this
            $.ajax({
                url : '{% url "get_price_list_percentage" 0 %}'.replace('0',parseInt($('#price_display').val())),
                type : 'GET',
                data : {

                },
                success: function(response){
                    var percentage_val = parseFloat(response.price_list_percentage)
                    if(response.percentage_type == 'Markup')
                    {
                        $(self).find('.total').val(parseFloat(parseFloat(total_amnt) + ((parseFloat(percentage_val) * parseFloat(total_amnt)) / 100)));
                    }
                    else if(response.percentage_type == 'Markdown')
                    {
                        $(self).find('.total').val(parseFloat(parseFloat(total_amnt) - ((parseFloat(percentage_val) * parseFloat(total_amnt)) / 100)));
                    }
                    else{
                        // alert('evrything wrong')
                    }
                },
                error:function(error){
                    // alert('error')
                }
            })

            calc_total();
        }
    });
}

function calc_total() {
        
    total = 0;
    $('.total').each(function () {
        total += parseFloat($(this).val());
    });
    taxamount = 0;
    $('.itemTaxAmount').each(function () {
        taxamount += parseFloat($(this).val());
    });
    $('#sub_total').val(total.toFixed(2));
    $('#tax_amount').val(taxamount.toFixed(2));
    var ship = parseFloat($("#ship").val());
    var adj_val = parseFloat($('#adj').val())
    var gtot = taxamount + total + ship + adj_val;

    $('#grandtotal').val(gtot.toFixed(2));
    
    var adv_val = parseFloat($('#advance').val())
    var bal = gtot - adv_val
    $('#balance').val(bal.toFixed(2));
    splitTax();
}

function splitTax(){
    var bc = $("#placeOfSupply").val();
    var compstate = $("#state1").val();
    
    d=0
    if (bc == compstate  ) {
        var gst = taxamount/2

        $('#cgstAmount1').val(parseFloat(gst.toFixed(2)));
        $('#sgstAmount1').val(parseFloat(gst.toFixed(2)));
        $('#igstAmount1').val(parseFloat(d.toFixed(2)));
    }else{

        $('#igstAmount1').val(taxamount.toFixed(2));
        $('#cgstAmount1').val(d.toFixed(2));
        $('#sgstAmount1').val(d.toFixed(2));
    }   
}

$(document).ready(function(){
    $("#ship").on('keyup change',function() {



        var subtot = $('#sub_total').val();
        var tax = $('#tax_amount').val();
        var sh = $("#ship").val();
        var adj = $("#adj").val();
        $('#grandtotal').val((parseFloat(subtot)+parseFloat(tax)+parseFloat(sh)+parseFloat(adj)).toFixed(2));
        $('#balance').val((parseFloat($("#grandtotal").val())-parseFloat($("#advance").val())).toFixed(2))
        
    });

    $(document).on("blur", "#ship", function(){
        if($(this).val() != ""){
        }else{
        $(this).val(0);
        calc_total();
        }
    }); 
});

$(document).ready(function(){
    $("#adj").on('keyup change',function() {

        var subtot = $('#sub_total').val();
        var tax = $('#tax_amount').val();
        var sh = $("#ship").val();
        var adj = $("#adj").val();
        $('#grandtotal').val((parseFloat(subtot)+parseFloat(tax)+parseFloat(sh)+parseFloat(adj)).toFixed(2));
        $('#balance').val((parseFloat($("#grandtotal").val())-parseFloat($("#advance").val())).toFixed(2))
    });

    $(document).on("blur", "#adj", function(){
        if($(this).val() != ""){
        }else{
        $(this).val(0);
        calc_total();
        }
    }); 
});

$(document).ready(function() {
    $("#advance").on('keyup change',function() {
        var tot_val = $('#grandtotal').val();
        var adv_val = $('#advance').val();
        if(adv_val !=""){
            if (parseFloat(tot_val) < parseFloat(adv_val)){
                $('#advance').val(parseFloat(tot_val))
                $('#balance').val(0);
                alert("Advance Greater than Total Amount")
    
            }else{
                var bal = parseFloat(tot_val) - parseFloat(adv_val)
                $('#balance').val(bal.toFixed(2));
            }
        }else{
            $('#balance').val(parseFloat(tot_val));
        }
        
    })
});

// Tabel row add, clone, remove

function refreshIndex(){
    var slNo = 1;
    var $rows = $("#items-table-body tr");

    for (var i = 0; i < $rows.length; i++) {
        $rows.eq(i).attr('id', 'tab_row'+slNo)
        $rows.eq(i).find('[id]').each(function() {
            var oldId = $(this).attr('id');
            var newId = oldId.replace(/\d+/, slNo);
            $(this).attr('id', newId );
        });

        $rows.eq(i).find('.nnum').text(slNo);
        slNo++;
    }
}

$(document).on('click','.remove_row',function(){
    var row_id = $(this).attr("id");
    $('#tab_row'+row_id+'').remove();
    refreshIndex();
    calc();
});


$(document).on('click','.clone_row',function(){
    var roinc = $("#items-table-body tr").length;
    var originalRow = $(this).closest('#items-table-body tr'); 
    var clonedRow = originalRow.clone();

    clonedRow.find('.tax_ref_gst').each(function() {
        $(this).val(originalRow.find('.tax_ref_gst').val());
    });
    clonedRow.find('.tax_ref_igst').each(function() {
        $(this).val(originalRow.find('.tax_ref_igst').val());
    });
    clonedRow.find('.item-display').val('');
    originalRow.after(clonedRow);
    refreshIndex();
    calc();
    
});



$(document).ready(function(){
$('#add').click(function(){
var roinc = $("#items-table-body tr").length;
roinc++
$('#items-table-body').append(
    `
    <tr id='tab_row${roinc}'>
        <td class="nnum" style="text-align: center;">${roinc}</td>
        <td style="width: 20%;">
            <div class="d-flex">
                <div class="w-100">
                    <div class="p-0 border-0 bg-none position-relative drop-box" style="display: block;">
                        <input required type="text" id="item${roinc}" value="" name="item_name[]" class="dropdown-toggle form-control item-display" onkeyup="filterFunction($(this).attr('id'))"  data-toggle="dropdown" aria-expanded="false" placeholder="Items.." autocomplete="off">
                        <ul class="dropdown-menu w-100 items-available position-absolute" id="menu${roinc}"  style="overflow-y: auto; height: fit-content;max-height: 40vh;"> 
                          {% for i in p %}
                            <li class="dropdown-item items-options" onclick="getItemDetails($(this).parent().prev().attr('id'),$(this).html())">{{i.item_name}}</li>
                            {% endfor %}
                        </ul>
                        
                    </div>
                </div>
                <a href="#">
                    <button type="button" class="btn btn-outline-warning ml-1" data-target="#newitem" data-toggle="modal">+</button>
                </a>
            </div>
        
        </td>
        <td>
            <input type="hidden" name="item_id[]" id="itemId${roinc}">
            <input type="text" name='hsn[]' id="hsn${roinc}" placeholder='HSN Code' class="form-control HSNCODE"  readonly />
        </td>
        <td >
            <input type="number" name='qty[]' id="qty${roinc}"  class="form-control qty mb-1" step=0 min=1  value=0 onchange="changeItemQty(this.id)" required/>
            <input type="text" id="avl${roinc}" style="display: none;">
            <div class="d-flex"><span>Avail Qty: </span><span id="qtyspan${roinc}" class=''></span></div>
        </td>
        <td>
            <input type="number" name='price[]' id="price${roinc}" class="form-control price" step="0.00" min="0"  value=0 readonly />
            <input type="number" name='priceListPrice[]' id="priceListPrice${roinc}" class="form-control priceListPrice" step="0.00" min="0" style="background-color: #43596c; color: white;display: none;" value=0 readonly />
        </td>
        
        <td style="width: 13%;">
            <!-- <input type="text"  id="select_tax" placeholder="Tax Rate" class="form-control seltax d-flex"> -->
            <select name='taxGST[]' id="taxGST${roinc}" class="form-control tax_ref tax_ref_gst" style="display: block;" onchange="taxchange(this.id)">
                <option selected disabled hidden>Select GST</option>
                <option value=28 >28.0% GST</option>
                <option value=18 >18.0% GST</option>
                <option value=12 >12.0% GST</option>
                <option value=5 >05.0% GST</option>
                <option value=3 >03.0% GST</option>
                <option value=0 >0.0% GST</option>
            </select>
            <select name='taxIGST[]' id="taxIGST${roinc}" class="form-control tax_ref tax_ref_igst" style="display: none;" onchange="taxchange(this.id)">
                <option selected disabled hidden >Select IGST</option>
                <option value=28 >28.0% IGST</option>
                <option value=18 >18.0% IGST</option>
                <option value=12 >12.0% IGST</option>
                <option value=5 >05.0% IGST</option>
                <option value=3 >03.0% IGST</option>
                <option value=0 >0.0% IGST</option>
            </select>
            <div class="mt-1" style=" text-align: center;color: red;" ><span id="invalidtax${roinc}" style="display: none;"> Invalid Tax %</span> </div>    
        </td>
        <td >
            <input type="number" name='discount[]'  placeholder='Enter Discount' id="disc${roinc}" value=0 class="form-control disc" step=0 min=0   />
        </td>

        <td><input type="number" name='total[]' id="total${roinc}" class="form-control total" value=0 readonly  /></td>
        <td style="display: none;"><input type="hidden" id="taxamount${roinc}" class="form-control itemTaxAmount" /></td>
        <td>
            <button type="button" id="${roinc}" class="btn btn-warning font-weight-bold clone_row fa fa-clone px-2 my-1 py-1" title="Clone Row" ></button><br>
            <button type="button" id="${roinc}" class="btn btn-danger remove_row px-2 py-1 mx-1 fa fa-close" title="Remove Row"> </button>
        </td>
    </tr>
    `);
    checkPriceList();
});
});


function validateForm() {
    var cust = $('#customer').val();
    var length = $("#items-table-body tr").length;

    if(length < 1){
        alert('Add atleast 1 item..!')
        return false;
    }

    if(cust == 0){
        alert('Select customer..')
        return false;
    }
}


</script>



<!-- Add item -> scripts -->

<script>

    function ShowHideDiv(track) {
        var inventorytrack = document.getElementById("inventorytrack");
        inventorytrack.style.display = track.checked ? "flex" : "none";
    }

    function ShowHideDivi(inclusive) {
        var inter = document.getElementById("intrastateFiled");
        inter.style.display = inclusive.checked ? "block" : "none";
    }

    function validateHSN() {
        var hsnField = document.getElementById("hsnField");
        var errorText = document.getElementById("hsnError");
        var hsnValue = hsnField.value;

        if (hsnValue.length < 6) {
            errorText.innerText = "HSN must contain at least 6 digits";
            hsnField.setCustomValidity("HSN must contain at least 6 digits");
            hsnField.style.borderColor = "red";
        } else {
            errorText.innerText = "";
            hsnField.setCustomValidity(""); 
            hsnField.style.borderColor = ""; 
        }
    }

    function showdiv() {
        document.getElementById("taxableDiv").style.display = "flex";
    }
    
    function hidediv() {
        document.getElementById("taxableDiv").style.display = "none";
    }

    $(document).on("click","#saveItemUnit",function(){
        var name = $("#unit_name").val();
        if (name !=""){
            $.ajax({
                type : 'POST',
                url:"{% url 'saveItemUnit' %}",
                data:{
                    'name' : name,
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                },
                
                success: function(response) {
                    if(response.status){
                        document.getElementById("newUnitForm").reset();
                        reloadUnits();
                    }else{
                        alert(response.message)
                    }
                },         
            });
        }
        else{
            alert('Invalid')
        }
    });

    function reloadUnits() {
        $.ajax({
            url: "{% url 'show_unit_dropdown' %}",
            type: "GET",
            dataType: "json",
            data: $(this).serialize(),
            csrfmiddlewaretoken: '{{ csrf_token }}',

            success: function(data) {
                console.log("AJAX Success - Dropdown Data:", data);
                var dropdown = $('#itemUnit');
                dropdown.empty()
                dropdown.append(`<option selected disabled value="">Choose...</option>`);
                $.each(data, function(key, value) {
                    for(let i=0; i<value.length; i++){
                        dropdown.append($('<option></option>').attr('class', 'text-uppercase').text(value[i].name))
                    }
                });
            },
            error: function(xhr, status, error) {
                console.error(xhr.responseText);
            }
        });
    }
    $(document).ready(function(){
        var Acnt_desc = document.getElementById("acnt-desc");
        Acnt_desc.innerHTML=`
            <b>Expense</b> <br>Reflects expenses incurred for running normal business operations, such as :<br/>
            <ul>
                <li>1.Advertisements and Marketing</li>
                <li>2.Business Travel Expenses</li>
                <li>3.License Fees</li>
                <li>4.Utility Expenses</li>
            </ul>`;

            var selectedValue = $('#Account_type').val();
            $.ajax({
                type : 'GET',
                url:"{% url 'checkAccounts' %}",
                data:{
                    type : selectedValue,
                },
                
                success: function(response) {
                    if(response.status){
                        $('#subAccountCheck').css('display','block');
                        var dropdown = $('#parentAccount');
                        dropdown.empty();
                        dropdown.append(`<option selected disabled value="">--Choose--</option>`)
                        $.each(response, function(key, value) {
                            for(let i=0; i<value.length; i++){
                                dropdown.append($('<option></option>').text(value[i].name).val(value[i].name))
                            }
                        });
                    }else{
                        
                    }
                },         
            });
    })
    
    function AccountTypeChange(selectBox) {
        var selectElement = document.getElementById("Account_type");
        var selectedValue = selectElement.value;
        var Acnt_desc = document.getElementById("acnt-desc");
        var acctype = document.getElementById("acctype");

        switch(selectedValue) {
            case "Expense":
                Acnt_desc.innerHTML=`
                    <b>Expense</b> <br>Reflects expenses incurred for running normal business operations, such as :<br/>
                    <ul>
                        <li>1.Advertisements and Marketing</li>
                        <li>2.Business Travel Expenses</li>
                        <li>3.License Fees</li>
                        <li>4.Utility Expenses</li>
                    </ul>`;
                    acctype.value="Expense"
                break;
            case "Cost Of Goods Sold":
                Acnt_desc.innerHTML=`
                    <b>Expense</b> <br>This indicates the direct costs attributable to the production of the goods sold by a company such as:<br/>
                    <ul>
                        <li>1.Material and Labor costs</li>
                        <li>2.Cost of obtaining raw materials</li>
                    </ul>`;
                    acctype.value="Expense"
                break;
            case "Other Expense":
                Acnt_desc.innerHTML=`
                    <b>Expense</b> <br>Track miscellaneous expenses incurred for activities other than primary business operations or create additional accounts to track default expenses like insurance or contribution towards charity.<br/>`;
                    acctype.value="Expense"
                break;
            default:
            Acnt_desc.innerHTML=`<b>Account Type</b> <br>Select an account type..<br/>`;
        }

        if(selectedValue !=""){
            $('#subAccountCheck').css('display','none')
            $('#subAccountCheckBox').prop('checked', $('#subAccountCheckBox').prop('checked') ? false : false);
            $('#parentAccountValue').css('display','none');

            $.ajax({
                type : 'GET',
                url:"{% url 'checkAccounts' %}",
                data:{
                    type : selectedValue,
                },
                
                success: function(response) {
                    if(response.status){
                        $('#subAccountCheck').css('display','block');
                        var dropdown = $('#parentAccount');
                        dropdown.empty();
                        dropdown.append(`<option selected disabled value="">--Choose--</option>`)
                        $.each(response, function(key, value) {
                            for(let i=0; i<value.length; i++){
                                dropdown.append($('<option></option>').text(value[i].name).val(value[i].name))
                            }
                        });
                    }else{
                        
                    }
                },         
            });

        }

}

$(document).ready(function() {
    $('#subAccountCheckBox').change(function() {
        if ($(this).is(':checked')) {
            $('#parentAccountValue').css('display','block');
            $('#parentAccount').prop('required',true);
        } else {
            $('#parentAccountValue').css('display','none');
            $('#parentAccount').prop('required',false);
        }
    });
});

$(document).on("click","#saveNewAccount",function(){
    var name = $("#accountName").val();
    var type = $("#Account_type").val();
    var code = $("#account_code").val();
    var desc = $("#description").val();
    var subAcc = $("#subAccountCheckBox").prop('checked');
    var parentAcc = $("#parentAccount").val();
    console.log(name,type,code,desc,subAcc,parentAcc);

    if(subAcc && (parentAcc =="" || parentAcc == undefined) ){
        alert('Select a parent account.!')
        return;
    }

    if (name !="" && type !="" ){
        $.ajax({
            type : 'POST',
            url:"{% url 'createNewAccountFromItems' %}",
            data:{
                'account_name' : name,
                'account_type' : type,
                'account_code' : code,
                'subAccountCheckBox' : subAcc,
                'parent_account' : parentAcc,
                'description' : desc,
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            
            success: function(response) {
                if(response.status){
                    document.getElementById("newAccountForm").reset();
                    
                    var dropdown = $('#purchaseAccount');
                    dropdown.empty();
                    dropdown.append(`<option value="" disabled>--Choose--<option/>`);
                    $.each(response, function(key, value) {
                        for(let i=0; i<value.length; i++){
                            if(value[i].name == name){
                                dropdown.append($('<option selected></option>').text(value[i].name).val(value[i].name))
                            }else{
                                dropdown.append($('<option></option>').text(value[i].name).val(value[i].name))
                            }   
                        }
                    });

                }else{
                    alert("Something went wrong.!")
                }
            },         
        });
    }
    else{
        alert('Account name or Type cannot be blank.!')
    }
});


$(document).on("click","#saveNewItem",function(){
    var name = $("#itemName").val();
    var type = $("#itemType").val();
    var unit = $("#itemUnit").val();
    var hsn = $("#hsnField").val();
    if($('#inclusive').prop('checked') || $('#check').prop('checked')){
        if($('#inclusive').prop('checked')){
            var tax = 'taxable'
        }else{
            var tax = 'non taxable'
        }
    }else{
        alert("Should select any of tax reference")
        return
    }

    if (name !="" && type !="" && unit != "" && hsn != "" && tax != ""){
        $.ajax({
            type : 'POST',
            url:"{% url 'createInvoiceItem' %}",
            data:{
                'name' : name,
                'type' : type,
                'unit' : unit,
                'hsn' : hsn,
                'taxref' : tax,
                'intra_st' : $("#intraStateTax").val(),
                'inter_st' : $("#interStateTax").val(),
                'pcost' : $("#purprice").val(),
                'pur_account' : $("#purchaseAccount").val(),
                'pur_desc' : $("#purchaseDescription").val(),
                'salesprice' : $("#saleprice").val(),
                'sale_account' : $("#salesAccount").val(),
                'sale_desc' : $("#salesDescription").val(),
                'invacc' : $("#invAcc").val(),
                'stock' : $("#stockOnHand").val(),
                'stock_rate' : $("#stockRate").val(),
                'min_stock' : $("#minStock").val(),
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            
            success: function(response) {
                if(response.status){
                    console.log("AJAX Success",response)
                    document.getElementById("newItemForm").reset();

                    reloadItems();
                }else{
                    alert(response.message)
                }
            },         
        });
    }
    else{
        alert('Fill all required fields.!')
        return;
    }
});

function reloadItems() {
    $.ajax({
        url: "{% url 'getItems' %}",
        type: "GET",
        dataType: "json",
        data: {},
        csrfmiddlewaretoken: '{{ csrf_token }}',

        success: function(data) {
            $('#items-table-body tr').each(function () {
            var currentRow = $(this);
            var html = currentRow.html();
            
            if (html !== '') {
                currentRow.find(".items-available").find("li").remove();

                $.each(data, function(key, value) {
                    for (let i = 0; i < value.length; i++) {
                        currentRow.find(".items-available").append(`
                            <li class="dropdown-item items-options" onclick="getItemDetails($(this).parent().prev().attr('id'), '${value[i]}')">
                                ${value[i]}
                            </li>`
                        );
                    }
                });

                console.log('Success');
            }
        });


        },
        error: function(xhr, status, error) {
            console.error(xhr.responseText);
        }

    });
    if ($('#createNewAccount').hasClass('show')){
        $('#createNewAccount').modal('toggle');
    }

    if ($('#newunit').hasClass('show')){
        $('#newunit').modal('toggle');
    }
}
</script>
<script>
      
  // item modal

  $(document).ready(function() {

    $("#item-tax1").click(function() {
      $(".inter-intra").removeClass('d-none');
      $(".inter-intra").addClass('d-flex');

    });
    
    $("#item-tax2").click(function() {
    
      $(".inter-intra").removeClass('d-flex');
      $(".inter-intra").addClass("d-none");

    });
    });
    
    
    $(document).on("click","#itemSave",function(){
    
    if ($('input[name="radioOption"]:checked').val() == 'Goods'){
    
        itemtype = $('#item_type1').val();
      }
    else{
      itemtype = $('#item_type2').val();
    }
    
    if ($('input[name="radioOption1"]:checked').val() == 'Taxable'){
        inter_st = $('#inter').val();
        intra_st = $('#intra').val();
        var tax = 'taxable'

      }
    else{
      inter_st = 0;
      intra_st = 0;
      var tax = 'non taxable'

    }
    
    
    $.ajax({
        

      
      type : 'POST',
      url:"{% url 'invoice_item' %}",
      
      data:{
          type : itemtype,
          name : $("#item_name").val(),
          unit : $("#item_units").val(),
          hsn_number : $("#myInputField").val(),
          inter : inter_st,
          intra : intra_st,
          sell_price : $("#sell_price").val(),
          cost_price : $("#cost_price").val(),
          sell_acc : $("#sell_acc").val(),
          cost_acc : $("#cost_acc").val(),
          sell_desc : $("#sell_desc").val(),
          cost_desc : $("#cost_desc").val(),
          stock : $("#stockOnHand").val(),
          stock_rate : $("#stockRate").val(),
          min_stock : $("#minStock").val(),
          taxref : tax,


          
          csrfmiddlewaretoken: '{{ csrf_token }}'
          
        },
      
        success: function(response) {
          // console.log(response)
          document.getElementById("modalItem").reset();
          reloadItems();
        },
    });        
    });
    
    function reloadItems() {
        $.ajax({
            url: "{% url 'getItems' %}",
            type: "GET",
            dataType: "json",
            data: {},
            csrfmiddlewaretoken: '{{ csrf_token }}',
    
            success: function(data) {
                $('#items-table-body tr').each(function () {
                var currentRow = $(this);
                var html = currentRow.html();
                
                if (html !== '') {
                    currentRow.find(".items-available").find("li").remove();
    
                    $.each(data, function(key, value) {
                        for (let i = 0; i < value.length; i++) {
                            currentRow.find(".items-available").append(`
                                <li class="dropdown-item items-options" onclick="getItemDetails($(this).parent().prev().attr('id'), '${value[i]}')">
                                    ${value[i]}
                                </li>`
                            );
                        }
                    });
    
                    console.log('Success');
                }
            });
    
    
            },
            error: function(xhr, status, error) {
                console.error(xhr.responseText);
            }
    
        });
        if ($('#createNewAccount').hasClass('show')){
            $('#createNewAccount').modal('toggle');
        }
    
        if ($('#newunit').hasClass('show')){
            $('#newunit').modal('toggle');
        }
    }
    
</script>

<script>
    $(document).ready(function(){
        $('#gstInDisplay1').hide()
    })
    function get_vendors_details(data){
        var para_data = $(data).next('span').text()
        var para_data1 = parseInt(para_data)
        $.ajax({
        url:  "{% url 'get_vendors_details_for_recurr' 0 %}".replace('0',para_data1),
        type: 'GET',
        success: function(response){
            $('#gstType').val(response.vendor_gst_treat)
            if(response.vendor_gstin === 'null' || response.vendor_gstin === null)
            {
                $('#gstInDisplay').hide()
            }
            else
            {
                $('#gstInDisplay').show()
                $('#gstin').val(response.vendor_gstin)
            }
            $('#vendorEmail').val(response.vendor_email)
            $('#billAddress').val(response.vendor_address)
            $('#vendor_source_of_suppy').val(response.vendor_source_of_suppy)
            change_gst();
        },
        error: function(error){

        },
        })
    }
    function get_customer_details(data){
        var para_data = $(data).next('span').text()
        var para_data1 = parseInt(para_data)
        $.ajax({
        url:  "{% url 'get_customer_details_for_recurr' 0 %}".replace('0',para_data1),
        type: 'GET',
        success: function(response){
            $('#cust_gstType').val(response.customer_gst_treat)
            $('#account_list1').val(response.customer_first_name)
            if(response.customer_gstin === null || response.customer_gstin === 'null' )
            {
                $('#cust_gstInDisplay').hide()
            }
            else
            {
                $('#cust_gstInDisplay').show()
                $('#cust_gstin').val(response.customer_gstin)
            }
            $('#cust_Email').val(response.customer_email)
            $('#cust_bill_Address').val(response.customer_address)
            $('#place_of_supply').val(response.customer_place_of_supply)
            change_gst();
        },
        error: function(error){

        },
        })
    }
    $(document).ready(function(){
        $('#price_display').hide()
        $('#price_enable').on('change',function(){
            if($('#price_enable').prop('checked'))
            {
                $('#price_display').show()
            }
            else{
                $('#price_display').hide()
            }
        })
    })
    $('#workphone').on('input', function() {
        var wPhone = $(this).val();
        
        $.ajax({
            type: 'GET',
            url:'{% url "check_work_phone_exist" %}',
            data: {
                w_Phone: wPhone
            },
            success: function(response) {
                if (response.exists) {
                    $('#workphone_label').text('Work phone number already exists !');
                    $('#workphone').val('');
                }
                else{
                    $('#workphone_label').text('');
                }
                
            },
            error: function(xhr, status, error) {
                console.error('Error:', error);
            }
        });
    });
    // Work Phone Number Validation 
    $(document).ready(function () {
        $('#workphone').on('input', function () {
            var inputVal = $(this).val();
            var expr = /^[0-9]{7}$/;
            if (expr.test(inputVal)) {
                $('#work-phone-message').text('Valid work phone number').css('color', 'green');
            } else {
                $('#work-phone-message').text('Invalid work phone number').css('color', 'red');
            }
        });
    });
    function findDueDate(){
          var days = parseInt($('#credit_period').val())
          order_date =new Date($('#rec_bil_Date').val())
          console.log(days);
          console.log(order_date);
          if (!isNaN(order_date.getTime())) {
  
              const endDate = new Date(order_date);
              endDate.setDate(endDate.getDate() + days);
  
              const isoString = endDate.toISOString(); 
              const day = isoString.slice(8, 10);
              const month = isoString.slice(5, 7);
              const year = isoString.slice(0, 4);
  
              const formattedDate = `${year}-${month}-${day}`;
  
              document.getElementById("dueDate").value = formattedDate;
          } else {
                  alert("Please enter a valid date.");
                  $('#paymentTerm').val('')
          }
      }
  
      $('#credit_period').on('change', function () {
          findDueDate();
      });
      $(document).ready(function(){
        $('#saveCreditPeriod').on('click',function(){
            var trm = $('#termName').val();
            var dys = $("#termDays").val();
            if (trm !="" && dys !="")
            {
                $.ajax({
                    type:'POST',
                    url : '{% url "add_new_creadit_period" %}',
                    data: {
                        'term_name':trm,
                        'term_days':dys,
                        csrfmiddlewaretoken:'{{ csrf_token }}'
                    },
                    success:function(response){
                        $('#credit_period').append($('<option>',{
                            value:dys,
                            text:trm,
                        }))
                    },
                    error:function(error){
                        alert('credit name or days already exist? Enter a diffrent date or name')
                    }
                })
            }
            else{
                alert('fill both fields')
            }
        })
      })
      $(document).ready(function(){
        $('#save_repeat_every').on('click',function(){
            var repeat_type = $('#repeat_type').val();
            var repeat_duration = $("#repeat_duration").val();
            if (repeat_type !="" && repeat_duration !="")
            {
                $.ajax({
                    type:'POST',
                    url : '{% url "create_repeat_every" %}',
                    data: {
                        'repeat_type':repeat_type,
                        'repeat_duration':repeat_duration,
                        csrfmiddlewaretoken:'{{ csrf_token }}'
                    },
                    success:function(response){
                        $('#repeat_every_select').append($('<option>',{
                            value:repeat_duration+" "+repeat_type,
                            text: repeat_duration+" "+repeat_type,
                        }))
                    },
                    error:function(error){
                        alert('Repeat Type with duration already exist? Enter a diffrent Type and duration')
                    }
                })
            }
            else{
                alert('fill both fields')
            }
        })
      })
      
      $(document).ready(function () {
        $('#wphone_vendor').on('input', function () {
            var inputVal = $(this).val();
            var expr = /^[0-9]{7}$/;
            if (expr.test(inputVal)) {
                $('#work-phone-message').text('Valid work phone number').css('color', 'green');
            } else {
                $('#work-phone-message').text('Invalid work phone number').css('color', 'red');
            }
        });
    }); 

    $('#wphone_vendor').on('input', function() {
        var wPhone = $(this).val();
        
        $.ajax({
            type: 'GET',
            url:'{% url "check_vendor_work_phone_exist" %}',
            data: {
                w_Phone: wPhone
            },
            success: function(response) {
                if (response.exists) {
                    $('#workphone_label').text('Work phone number already exists !');
                    $('#workphone').val('');
                }
                else{
                    $('#workphone_label').text('');
                }
                
            },
            error: function(xhr, status, error) {
                console.error('Error:', error);
            }
        });
    });
    $('#mphone_vendor').on('input', function() {
        
        var mPhone = $(this).val();
        
        $.ajax({
            type: 'GET',
            url:'{% url "check_vendor_phonenumber_exist" %}',
            data: {
                m_Phone: mPhone
            },
            success: function(response) {
                if (response.exists) {
                    $('#mphone_label').text('Phone number already exists !');
                    $('#mphone').val('');
                }
                else{
                    $('#mphone_label').text('');
                }
                
            },
            error: function(xhr, status, error) {
                console.error('Error:', error);
            }
        });
    });
    $(document).ready(function () {
        $('#mphone_vendor').on('input', function () {
            var inputVal = $(this).val();
            var expr=/^[0-9]{10}$/;
            if (expr.test(inputVal)) {
                $('#phone-message').text('Valid  phone number').css('color', 'green');
            } else {
                $('#phone-message').text('Invalid  phone number').css('color', 'red');
            }
        });
    });
    $('#gst_type_vendor').on('change',function(){
        if($(this).val()==="Unregistered Business")
        {
            $('#hide_div').attr('hidden',true)
        }
        else{
            $('#hide_div').attr('hidden',false)
        }
    })
    $(document).on('change', '#vendor_source_of_suppy, #place_of_supply', function(){
        change_gst();
    });
    function change_gst(){
        if($('#vendor_source_of_suppy').val()===$('#place_of_supply').val())
        {
            $('.tax_ref_gst').css({'display':'block'});
            $('.tax_ref_igst').css({'display':'none'});
            
        }
        else{
            $('.tax_ref_gst').css({'display':'none'});
            $('.tax_ref_igst').css({'display':'block'});
        }
    }
</script>

<script>

    $(document).ready(function(){

    // Get the CSRF token from the cookie
        function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
        }
        var csrftoken = getCookie('csrftoken');

        // Pan Number Check

        $('#panInput').on('input', function(){
        var panNumber = $(this).val();
        var regex = /[A-Z]{5}[0-9]{4}[A-Z]{1}$/;
        if(regex.test(panNumber)) {
            $('#panMessage').text('PAN number is valid.').css('color', 'green');
            // PAN number is valid, call AJAX to check if it exists
            $.ajax({
            url: "{% url 'check_pan' %}",
            headers: {'X-CSRFToken': csrftoken}, 
            type: 'POST',
            data: {panNumber: panNumber},
            success: function(response) {
                if (response.status == 'exists') {
                    $('#panMessage').text('PAN number already exists.').css({
                        'color': 'red',
                        'font-size': '12px'
                    });
                    
                }
            }
            });
        } else {
            $('#panMessage').text('Please enter a valid PAN number.').css({
                'color': 'red',
                'font-size': '12px'
            });
        }
        });

        // Pna Number Check End 


        // GST Number Check 

        $('#gstInput').on('input', function(){
            var gstNumber = $(this).val();
            var regex = /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
            if(regex.test(gstNumber)) {
                $('#gstMessage').text('GST number is valid.').css('color', 'green');
                // GST number is valid, call AJAX to check if it exists
                $.ajax({
                    url: "{% url 'check_gst' %}",
                    headers: {'X-CSRFToken': csrftoken}, 
                    type: 'POST',
                    data: {gstNumber: gstNumber},
                    success: function(response) {
                        if (response.status == 'exists') {
                            $('#gstMessage').text('GST number already exists.').css({
                                'color': 'red',
                                'font-size': '12px'
                            });
                            
                        }
                    }
                    });
            } 
            else {
                $('#gstMessage').text('Please enter a valid GST number.').css({
                    'color': 'red',
                    'font-size': '12px'
                });
            }
            });
    
        // GST Number Check End 

    });

      // Name display 

        
      const Title = document.getElementById('select1');
const fname = document.getElementById('fname');
const laname = document.getElementById('lname');
const vDisplayName = document.getElementById('v_display_name');

// Listen for input events on the initial input fields
Title.addEventListener('input', updateOutputFields);
fname.addEventListener('input', updateOutputFields);
laname.addEventListener('input', updateOutputFields);

// Function to update the output fields
function updateOutputFields() {
    const selectedTitle = Title.value;
    const selectedFname = fname.value;
    const selectedLname = laname.value;

    // Clear existing options
    vDisplayName.innerHTML = '';
 // Add new options based on input field values
 const option1 = document.createElement('option');
    option1.text = selectedTitle + ' ' + selectedFname + ' ' + selectedLname;
    vDisplayName.add(option1);

   

    const option2 = document.createElement('option');
    option2.text = selectedFname + ' ' + selectedLname;
    vDisplayName.add(option2);

    const option3 = document.createElement('option');
    option3.text = selectedLname + ' ' + selectedFname;
    vDisplayName.add(option3);
}

</script>






<script>
    function gstPan_function(){
        var x=document.getElementById('GSTT').value
        if(x=="Unregistered Business-not Registered under GST")
        {
            document.getElementById("pan").style.display="block";
            document.getElementById("gst").style.display="none";

            
        }
        else if((x=="Registered Business-Regular Business that is registered under GST") || (x=="Registered Business-Composition Business that is registered under the Composition scheme in GST") || (x=="Overseas- Persons with who you do import or exports of supplies outside india") || (x=="Special Economic Zone"))
        {
            document.getElementById("gst").style.display="block";
            document.getElementById("pan").style.display="block";


        }
    
    }
  


    $(document).ready(function () {
        $(".toggle1").click(function (e) {
          e.preventDefault();
          $("fieldset1").toggle();
        })
      })
      $(document).ready(function () {
        $(".toggle2").click(function (e) {
          e.preventDefault();
         
          $("fieldset2").toggle(); 
          $("fieldset5").hide();
          $("fieldset6").hide();
          $("fieldset7").hide();


      
        })
      })

      $(document).ready(function () {
        $(".toggle3").click(function (e) {
          e.preventDefault();
          $("fieldset5").toggle();
          $("fieldset2").hide();
          $("fieldset6").hide();
          $("fieldset7").hide();

        })
      })
      $(document).ready(function () {
        $(".toggle4").click(function (e) {
          e.preventDefault();
          $("fieldset6").toggle();
          $("fieldset2").hide();
          $("fieldset5").hide();
          $("fieldset7").hide();
                
        })
      })
      $(document).ready(function () {
        $(".toggle7").click(function (e) {
          e.preventDefault();
          $("fieldset7").toggle();
          $("fieldset2").hide();
          $("fieldset6").hide();
          $("fieldset5").hide();
         

         
        })
      })

 
 
    $('document').ready(function () {
        $('.add_another').click(function () {
          $("#tbl").append(`<tr>
            <td>
                <select name="salutation[]" id="PLACE" class="form-control bg-transparent border-1 text-white">
                    <option value="Mr" class="text-dark" selected>Mr.</option>
                    <option class="text-dark" value=""Mrs">Mrs.</option>
                    <option class="text-dark" value="Ms">Ms.</option>
                    <option class="text-dark" value="Miss">Miss.</option>
                    <option class="text-dark" value="Dr">Dr.</option>
                </select>  
            </td>
            <td>
                <input type="text" name="first_name[]" class="form-control border-1 bg-transparent text-white"  value="" />
            </td>
            <td>
                <input type="text" name="last_name[]" class="form-control border-1 bg-transparent text-white"   value="" />
            </td>
            <td>
                <input type="email" name="email[]" class="form-control border-1 bg-transparent text-white" value="" />
            </td>
            <td>
                <input type="tel" pattern="[0-9]{7}" id="twphone" name="wphone[]" class="form-control border-1 bg-transparent text-white"  value="" />
            </td>
            <td>
                <input type="tel" pattern="[0-9]{10}" id="tmobile" onclick="sample1()" name="mobile[]" class="form-control border-1 bg-transparent text-white"  value="" />
            </td>
            <td>
                <input type="number" onclick="sample()" name="skype[]" class="form-control border-1 bg-transparent text-white"  value="" />
            </td>
            <td>
                <input type="text" name="designation[]" class="form-control border-1 bg-transparent text-white" value="" />
            </td>
            <td>
                <input type="text" name="department[]" class="form-control border-1 bg-transparent text-white" value="" />
            </td>
        </tr>`);
        });
      })

      function fieldset5_function()
      {
        document.getElementById("address").style.display="block";
      }

    

    function myCopyAddressFunction() {
        var checkBox = document.getElementById("myCheckT");
        var textatn = document.getElementById("batten");
        var txtcry = document.getElementById("bctry");
        var txtadrs11 = document.getElementById("badd1");
        var txtcty = document.getElementById("bcty");
        var txtstat = document.getElementById("bste");
        var txtzip = document.getElementById("bzp");
        var txtphone = document.getElementById("bphone_num");
        var txtfx = document.getElementById("bfx");
  
        var textatn1 = document.getElementById("satten");
        var txtcry1 = document.getElementById("sctry");
        var txtadrs21 = document.getElementById("sadd1");
        var txtcty1 = document.getElementById("scty");
        var txtstat1 = document.getElementById("sste");
        var txtzip1 = document.getElementById("szp");
        var txtphone1 = document.getElementById("sphone_num");
        var txtfx1 = document.getElementById("sfx");
        if (checkBox.checked == true) {
          textatn1.value = textatn.value;
          txtadrs21.value = txtadrs11.value;
          txtcty1.value = txtcty.value;
          txtstat1.value = txtstat.value;
          txtzip1.value = txtzip.value; 
          txtphone1.value = txtphone.value;
          txtfx1.value = txtfx.value;
          



          
  
        } else {
          txtadrs21.value = "";
          txtcty1.value = "";
          txtstat1.value = "";
          txtzip1.value = "";
          txtphone1.value = "";
          txtfx1.value = "";
          txtcry1.value = "";
          textatn1.value = "";

  
        }
      }


      function open_table()
      {
        document.getElementById("hid").style.display="block";
        
      }



    

      function bphone_number()
      {
        var a1=document.getElementById("bphone_num").value;
        var b1=document.getElementById("bphone_label");
        var expr=/^[0-9]{10}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Invalid Phone Number.";
        }
        else{
            b1.style.color="green";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Valid Phone Number.";

        }
      }

      function sphone_number()
      {
        var a1=document.getElementById("sphone_num").value;
        var b1=document.getElementById("sphone_label");
        var expr=/^[0-9]{10}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Invalid Fax Number.";
        }
        else{
            b1.style.color="green";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Valid Fax Number.";

        }
      }

      function fax_number()
      {
        var a1=document.getElementById("bfx").value;
        var b1=document.getElementById("fax_label");
        var expr=/^[0-9]{7}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Invalid Fax Number.";
        }
        else{
            b1.style.color="green";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Valid Fax Number.";

        }
      }

      function sfax_number()
      {
        var a1=document.getElementById("sfx").value;
        var b1=document.getElementById("sfax_label");
        var expr=/^[0-9]{7}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Invalid Phone Number.";
        }
        else{
            b1.style.color="green";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Valid Phone Number.";

        }
      }

    
      function sample()
      {

        var tbldata = document.getElementById("tbl");
        var total_rows = tbldata.rows.length;
        x=document.getElementById("tbl");
        var a1=x.rows[total_rows-1].cells[5].getElementsByTagName('input')[0].value;

        var b1=document.getElementById("tlabel");

        b1.innerHTML = "";

        var expr=/^[0-9]{10}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.innerHTML = "Invalid";
            b1.style.fontSize="0.750rem";
        }
        else{
            b1.style.color="green";
            b1.innerHTML = "Valid";
            b1.style.fontSize="0.750rem";

        }

       

      }

      function sample1()
      {

        var tbldata = document.getElementById("tbl");
        var total_rows = tbldata.rows.length;
        x=document.getElementById("tbl");
        var a1=x.rows[total_rows-1].cells[4].getElementsByTagName('input')[0].value;

        var b1=document.getElementById("twph_label");

        b1.innerHTML = "";

        var expr=/^[0-9]{7}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.innerHTML = "Invalid";
            b1.style.fontSize="0.750rem";
        }
        else{
            b1.style.color="green";
            b1.innerHTML = "valid";
            b1.style.fontSize="0.750rem";

        }


      }


</script>

<script type="text/javascript">
    function vendor_display()
    {
        var x=document.getElementById("select1").value;
        var y=document.getElementById("fname").value;
        var z=document.getElementById("lname").value;

        document.getElementById("select2").innerHTML=x+" "+y+" "+z
    
        
    }
</script>

<script>
    $(document).on("click","#termSave",function(){
   

  $.ajax({
    type : 'POST',
    url:"{% url 'payment_terms_add' %}",

    data:{
        name : $("#tname").val(),
        days : $("#tdays").val(),
        
        csrfmiddlewaretoken: '{{ csrf_token }}'
        
      },
    
      success: function(response) {
        $("#tname").val('')
        $("#tdays").val('')
        var paytearmSelect = $('#paytearm-select'); 
          paytearmSelect.empty();  // Clear existing options
          

          // Add "Select" option
          paytearmSelect.append('<option value="Due on Receipt" selected>Due on Receipt</option>');

          // Add new options based on the Ajax response
          $.each(response.payment_list, function(index, pay_terms) {
            paytearmSelect.append('<option value="' + pay_terms.id + '">' + pay_terms.name + '</option>');
          });
        // reloadPayment();
      },
  });        
});


</script>
<script>
    // Get the input element
    const inputElement = document.getElementById("tname");

    // Add event listener for input event
    inputElement.addEventListener("input", function() {
        // Convert the input value to uppercase
        this.value = this.value.toUpperCase();
    });
</script>

<script>

$(document).ready(function() {
    $('#tname').on('input', function() {
        
        var termName = $(this).val();
       
        $.ajax({
            type: 'GET',
            url:'{% url "check_term_exist" %}',
            data: {
                term_name: termName
            },
            success: function(response) {
                if (response.exists) {
                    $('#message-id').text('Term already exists !');
                    $('#success-message-id').text('');
                  
                    $('#tname').val('');
                } else {
                    $('#success-message-id').text('Term name available !');
                    $('#message-id').text('');
                }
                
            },
            error: function(xhr, status, error) {
                console.error('Error:', error);
            }
        });
    });
});

$('#vendor-email').on('input', function() {
        
    var vendorEmail = $(this).val();
    console.log(vendorEmail)
    $.ajax({
        type: 'GET',
        url:'{% url "check_email_exist" %}',
        data: {
            vendor_email: vendorEmail
        },
        success: function(response) {
            if (response.exists) {
                $('#email-message-id').text('Email id already exists !');
                $('#vendor-email').val('');
            }
            else{
                $('#email-message-id').text('');
            }
            
        },
        error: function(xhr, status, error) {
            console.error('Error:', error);
        }
    });
});

$('#workphone').on('input', function() {
        
    var wPhone = $(this).val();
    
    $.ajax({
        type: 'GET',
        url:'{% url "check_work_phone_exist" %}',
        data: {
            w_Phone: wPhone
        },
        success: function(response) {
            if (response.exists) {
                $('#workphone_label').text('Work phone number already exists !');
                $('#workphone').val('');
            }
            else{
                $('#workphone_label').text('');
            }
            
        },
        error: function(xhr, status, error) {
            console.error('Error:', error);
        }
    });
});


$('#mphone').on('input', function() {
        
    var mPhone = $(this).val();
    
    $.ajax({
        type: 'GET',
        url:'{% url "check_phonenumber_exist" %}',
        data: {
            m_Phone: mPhone
        },
        success: function(response) {
            if (response.exists) {
                $('#mphone_label').text('Phone number already exists !');
                $('#mphone').val('');
            }
            else{
                $('#mphone_label').text('');
            }
            
        },
        error: function(xhr, status, error) {
            console.error('Error:', error);
        }
    });
});

</script>



<script>
    // Work Phone Number Validation 
    $(document).ready(function () {
        $('#workphone').on('input', function () {
            var inputVal = $(this).val();
            var expr = /^[0-9]{7}$/;
            if (expr.test(inputVal)) {
                $('#work-phone-message').text('Valid work phone number').css('color', 'green');
            } else {
                $('#work-phone-message').text('Invalid work phone number').css('color', 'red');
            }
        });
    });

    // Phone Number Validation
    $(document).ready(function () {
        $('#mphone').on('input', function () {
            var inputVal = $(this).val();
            var expr=/^[0-9]{10}$/;
            if (expr.test(inputVal)) {
                $('#phone-message').text('Valid  phone number').css('color', 'green');
            } else {
                $('#phone-message').text('Invalid  phone number').css('color', 'red');
            }
        });
    });
</script>

<!-- add new customer  script start -->
<script>
    $(document).ready(function() {
    $('#newCustomerForm').submit(function(event) {
        event.preventDefault(); // Prevent default form submission behavior

        // Submit form using AJAX
        $.ajax({
            url: $(this).attr('action'),
            type: 'POST',
            data: $(this).serialize(), // Serialize form data
            success: function(response) {
                // Update HTML with the response
                // Create the <p> element
                var paragraphElement = $('<p>', {
                    class: 'account_drop_hovers1 ps-3 p-2 m-0',
                    onclick: 'get_customer_details(this)',
                    text: response.customer_fname
                });

                // Create the <span> element
                var spanElement = $('<span>', {
                    hidden: true,
                    text: response.customer_id
                });

                // Append the elements to the 'customer_add' div
                $('#customer_add').append(paragraphElement, spanElement);
                // Get the modal element
                var modal = document.getElementById('newCustomer');

                // Hide the modal by setting its display property to "none"
                modal.style.display = 'none';
                $('.modal-backdrop').remove(); 

            },
            error: function(xhr, status, error) {
                // Handle error if necessary
                console.error('AJAX request failed:', error);
            }
        });
    });
});

$(document).ready(function(){
    $('#bill_number').on('input',function(){
        $.ajax({
            url : '{% url "check_rec_bill_no_valid" %}',
            type : 'POST',
            data : {
                'bill_no': $(this).val(),
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            success: function(response){
                $('#invalid_recurr_no_indicator').attr('hidden',true)
            },
            error:function(error){
                $('#invalid_recurr_no_indicator').attr('hidden',false)
            }
        })
    })
})
$(document).ready(function(){
    $('#price_display').on('change',function(){
        calc()
    })
})
$(document).ready(function(){
    $('#price_enable').on('change',function(){
        if(!$('#price_enable').prop('checked')){
            $('#price_display').val('0')
        }
        calc()
    })
})
</script>
<!-- add new customer  script end-->


<!-- final submition of recurring bill start -->

<!-- final submition of recurring bill end -->

{% endblock %}
